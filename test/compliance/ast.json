[
  {
    "given": {
      "foo": {
        "bar": {
          "baz": "correct"
        }
      }
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "foo"
        },
        "result": {
          "bar": {
            "baz": "correct"
          }
        }
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Field",
              "name": "bar"
            }
          ]
        },
        "result": {
          "baz": "correct"
        }
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Field",
                  "name": "bar"
                }
              ]
            },
            {
              "type": "Field",
              "name": "baz"
            }
          ]
        },
        "result": "correct"
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Field",
                  "name": "bar"
                }
              ]
            },
            {
              "type": "Field",
              "name": "baz"
            }
          ]
        },
        "result": "correct"
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Subexpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "foo"
                    },
                    {
                      "type": "Field",
                      "name": "bar"
                    }
                  ]
                },
                {
                  "type": "Field",
                  "name": "baz"
                }
              ]
            },
            {
              "type": "Field",
              "name": "bad"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Field",
                  "name": "bar"
                }
              ]
            },
            {
              "type": "Field",
              "name": "bad"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Field",
              "name": "bad"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Field",
          "name": "bad"
        },
        "result": null
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "bad"
                },
                {
                  "type": "Field",
                  "name": "morebad"
                }
              ]
            },
            {
              "type": "Field",
              "name": "morebad"
            }
          ]
        },
        "result": null
      }
    ]
  },
  {
    "given": {
      "foo": {
        "bar": [
          "one",
          "two",
          "three"
        ]
      }
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "foo"
        },
        "result": {
          "bar": [
            "one",
            "two",
            "three"
          ]
        }
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Field",
              "name": "bar"
            }
          ]
        },
        "result": [
          "one",
          "two",
          "three"
        ]
      }
    ]
  },
  {
    "given": [
      "one",
      "two",
      "three"
    ],
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "one"
        },
        "result": null
      },
      {
        "expression": {
          "type": "Field",
          "name": "two"
        },
        "result": null
      },
      {
        "expression": {
          "type": "Field",
          "name": "three"
        },
        "result": null
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "one"
            },
            {
              "type": "Field",
              "name": "two"
            }
          ]
        },
        "result": null
      }
    ]
  },
  {
    "given": {
      "foo": {
        "1": [
          "one",
          "two",
          "three"
        ],
        "-1": "bar"
      }
    },
    "cases": [
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Field",
              "name": "1"
            }
          ]
        },
        "result": [
          "one",
          "two",
          "three"
        ]
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "1"
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": "one"
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Field",
              "name": "-1"
            }
          ]
        },
        "result": "bar"
      }
    ]
  },
  {
    "given": {
      "outer": {
        "foo": "foo",
        "bar": "bar",
        "baz": "baz"
      }
    },
    "cases": [
      {
        "expression": {
          "type": "OrExpression",
          "children": [
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "outer"
                },
                {
                  "type": "Field",
                  "name": "foo"
                }
              ]
            },
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "outer"
                },
                {
                  "type": "Field",
                  "name": "bar"
                }
              ]
            }
          ]
        },
        "result": "foo"
      },
      {
        "expression": {
          "type": "OrExpression",
          "children": [
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "outer"
                },
                {
                  "type": "Field",
                  "name": "foo"
                }
              ]
            },
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "outer"
                },
                {
                  "type": "Field",
                  "name": "bar"
                }
              ]
            }
          ]
        },
        "result": "foo"
      },
      {
        "expression": {
          "type": "OrExpression",
          "children": [
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "outer"
                },
                {
                  "type": "Field",
                  "name": "bar"
                }
              ]
            },
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "outer"
                },
                {
                  "type": "Field",
                  "name": "baz"
                }
              ]
            }
          ]
        },
        "result": "bar"
      },
      {
        "expression": {
          "type": "OrExpression",
          "children": [
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "outer"
                },
                {
                  "type": "Field",
                  "name": "bar"
                }
              ]
            },
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "outer"
                },
                {
                  "type": "Field",
                  "name": "baz"
                }
              ]
            }
          ]
        },
        "result": "bar"
      },
      {
        "expression": {
          "type": "OrExpression",
          "children": [
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "outer"
                },
                {
                  "type": "Field",
                  "name": "bad"
                }
              ]
            },
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "outer"
                },
                {
                  "type": "Field",
                  "name": "foo"
                }
              ]
            }
          ]
        },
        "result": "foo"
      },
      {
        "expression": {
          "type": "OrExpression",
          "children": [
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "outer"
                },
                {
                  "type": "Field",
                  "name": "bad"
                }
              ]
            },
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "outer"
                },
                {
                  "type": "Field",
                  "name": "foo"
                }
              ]
            }
          ]
        },
        "result": "foo"
      },
      {
        "expression": {
          "type": "OrExpression",
          "children": [
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "outer"
                },
                {
                  "type": "Field",
                  "name": "foo"
                }
              ]
            },
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "outer"
                },
                {
                  "type": "Field",
                  "name": "bad"
                }
              ]
            }
          ]
        },
        "result": "foo"
      },
      {
        "expression": {
          "type": "OrExpression",
          "children": [
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "outer"
                },
                {
                  "type": "Field",
                  "name": "foo"
                }
              ]
            },
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "outer"
                },
                {
                  "type": "Field",
                  "name": "bad"
                }
              ]
            }
          ]
        },
        "result": "foo"
      },
      {
        "expression": {
          "type": "OrExpression",
          "children": [
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "outer"
                },
                {
                  "type": "Field",
                  "name": "bad"
                }
              ]
            },
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "outer"
                },
                {
                  "type": "Field",
                  "name": "alsobad"
                }
              ]
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "OrExpression",
          "children": [
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "outer"
                },
                {
                  "type": "Field",
                  "name": "bad"
                }
              ]
            },
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "outer"
                },
                {
                  "type": "Field",
                  "name": "alsobad"
                }
              ]
            }
          ]
        },
        "result": null
      }
    ]
  },
  {
    "given": {
      "outer": {
        "foo": "foo",
        "bool": false,
        "empty_list": [],
        "empty_string": ""
      }
    },
    "cases": [
      {
        "expression": {
          "type": "OrExpression",
          "children": [
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "outer"
                },
                {
                  "type": "Field",
                  "name": "empty_string"
                }
              ]
            },
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "outer"
                },
                {
                  "type": "Field",
                  "name": "foo"
                }
              ]
            }
          ]
        },
        "result": "foo"
      },
      {
        "expression": {
          "type": "OrExpression",
          "children": [
            {
              "type": "OrExpression",
              "children": [
                {
                  "type": "OrExpression",
                  "children": [
                    {
                      "type": "OrExpression",
                      "children": [
                        {
                          "type": "Subexpression",
                          "children": [
                            {
                              "type": "Field",
                              "name": "outer"
                            },
                            {
                              "type": "Field",
                              "name": "nokey"
                            }
                          ]
                        },
                        {
                          "type": "Subexpression",
                          "children": [
                            {
                              "type": "Field",
                              "name": "outer"
                            },
                            {
                              "type": "Field",
                              "name": "bool"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "Subexpression",
                      "children": [
                        {
                          "type": "Field",
                          "name": "outer"
                        },
                        {
                          "type": "Field",
                          "name": "empty_list"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "Subexpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "outer"
                    },
                    {
                      "type": "Field",
                      "name": "empty_string"
                    }
                  ]
                }
              ]
            },
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "outer"
                },
                {
                  "type": "Field",
                  "name": "foo"
                }
              ]
            }
          ]
        },
        "result": "foo"
      }
    ]
  },
  {
    "given": {
      "True": true,
      "False": false,
      "Number": 5,
      "EmptyList": [],
      "Zero": 0
    },
    "cases": [
      {
        "expression": {
          "type": "AndExpression",
          "children": [
            {
              "type": "Field",
              "name": "True"
            },
            {
              "type": "Field",
              "name": "False"
            }
          ]
        },
        "result": false
      },
      {
        "expression": {
          "type": "AndExpression",
          "children": [
            {
              "type": "Field",
              "name": "False"
            },
            {
              "type": "Field",
              "name": "True"
            }
          ]
        },
        "result": false
      },
      {
        "expression": {
          "type": "AndExpression",
          "children": [
            {
              "type": "Field",
              "name": "True"
            },
            {
              "type": "Field",
              "name": "True"
            }
          ]
        },
        "result": true
      },
      {
        "expression": {
          "type": "AndExpression",
          "children": [
            {
              "type": "Field",
              "name": "False"
            },
            {
              "type": "Field",
              "name": "False"
            }
          ]
        },
        "result": false
      },
      {
        "expression": {
          "type": "AndExpression",
          "children": [
            {
              "type": "Field",
              "name": "True"
            },
            {
              "type": "Field",
              "name": "Number"
            }
          ]
        },
        "result": 5
      },
      {
        "expression": {
          "type": "AndExpression",
          "children": [
            {
              "type": "Field",
              "name": "Number"
            },
            {
              "type": "Field",
              "name": "True"
            }
          ]
        },
        "result": true
      },
      {
        "expression": {
          "type": "AndExpression",
          "children": [
            {
              "type": "Field",
              "name": "Number"
            },
            {
              "type": "Field",
              "name": "False"
            }
          ]
        },
        "result": false
      },
      {
        "expression": {
          "type": "AndExpression",
          "children": [
            {
              "type": "Field",
              "name": "Number"
            },
            {
              "type": "Field",
              "name": "EmptyList"
            }
          ]
        },
        "result": []
      },
      {
        "expression": {
          "type": "AndExpression",
          "children": [
            {
              "type": "Field",
              "name": "Number"
            },
            {
              "type": "Field",
              "name": "True"
            }
          ]
        },
        "result": true
      },
      {
        "expression": {
          "type": "AndExpression",
          "children": [
            {
              "type": "Field",
              "name": "EmptyList"
            },
            {
              "type": "Field",
              "name": "True"
            }
          ]
        },
        "result": []
      },
      {
        "expression": {
          "type": "AndExpression",
          "children": [
            {
              "type": "Field",
              "name": "EmptyList"
            },
            {
              "type": "Field",
              "name": "False"
            }
          ]
        },
        "result": []
      },
      {
        "expression": {
          "type": "OrExpression",
          "children": [
            {
              "type": "Field",
              "name": "True"
            },
            {
              "type": "Field",
              "name": "False"
            }
          ]
        },
        "result": true
      },
      {
        "expression": {
          "type": "OrExpression",
          "children": [
            {
              "type": "Field",
              "name": "True"
            },
            {
              "type": "Field",
              "name": "True"
            }
          ]
        },
        "result": true
      },
      {
        "expression": {
          "type": "OrExpression",
          "children": [
            {
              "type": "Field",
              "name": "False"
            },
            {
              "type": "Field",
              "name": "True"
            }
          ]
        },
        "result": true
      },
      {
        "expression": {
          "type": "OrExpression",
          "children": [
            {
              "type": "Field",
              "name": "False"
            },
            {
              "type": "Field",
              "name": "False"
            }
          ]
        },
        "result": false
      },
      {
        "expression": {
          "type": "OrExpression",
          "children": [
            {
              "type": "Field",
              "name": "Number"
            },
            {
              "type": "Field",
              "name": "EmptyList"
            }
          ]
        },
        "result": 5
      },
      {
        "expression": {
          "type": "OrExpression",
          "children": [
            {
              "type": "Field",
              "name": "Number"
            },
            {
              "type": "Field",
              "name": "True"
            }
          ]
        },
        "result": 5
      },
      {
        "expression": {
          "type": "OrExpression",
          "children": [
            {
              "type": "Field",
              "name": "Number"
            },
            {
              "type": "AndExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "True"
                },
                {
                  "type": "Field",
                  "name": "False"
                }
              ]
            }
          ]
        },
        "result": 5
      },
      {
        "expression": {
          "type": "AndExpression",
          "children": [
            {
              "type": "OrExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "Number"
                },
                {
                  "type": "Field",
                  "name": "True"
                }
              ]
            },
            {
              "type": "Field",
              "name": "False"
            }
          ]
        },
        "result": false
      },
      {
        "expression": {
          "type": "OrExpression",
          "children": [
            {
              "type": "Field",
              "name": "Number"
            },
            {
              "type": "AndExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "True"
                },
                {
                  "type": "Field",
                  "name": "False"
                }
              ]
            }
          ]
        },
        "result": 5
      },
      {
        "expression": {
          "type": "NotExpression",
          "children": [
            {
              "type": "Field",
              "name": "True"
            }
          ]
        },
        "result": false
      },
      {
        "expression": {
          "type": "NotExpression",
          "children": [
            {
              "type": "Field",
              "name": "False"
            }
          ]
        },
        "result": true
      },
      {
        "expression": {
          "type": "NotExpression",
          "children": [
            {
              "type": "Field",
              "name": "Number"
            }
          ]
        },
        "result": false
      },
      {
        "expression": {
          "type": "NotExpression",
          "children": [
            {
              "type": "Field",
              "name": "EmptyList"
            }
          ]
        },
        "result": true
      },
      {
        "expression": {
          "type": "AndExpression",
          "children": [
            {
              "type": "Field",
              "name": "True"
            },
            {
              "type": "NotExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "False"
                }
              ]
            }
          ]
        },
        "result": true
      },
      {
        "expression": {
          "type": "AndExpression",
          "children": [
            {
              "type": "Field",
              "name": "True"
            },
            {
              "type": "NotExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "EmptyList"
                }
              ]
            }
          ]
        },
        "result": true
      },
      {
        "expression": {
          "type": "AndExpression",
          "children": [
            {
              "type": "NotExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "False"
                }
              ]
            },
            {
              "type": "NotExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "EmptyList"
                }
              ]
            }
          ]
        },
        "result": true
      },
      {
        "expression": {
          "type": "NotExpression",
          "children": [
            {
              "type": "AndExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "True"
                },
                {
                  "type": "Field",
                  "name": "False"
                }
              ]
            }
          ]
        },
        "result": true
      },
      {
        "expression": {
          "type": "NotExpression",
          "children": [
            {
              "type": "Field",
              "name": "Zero"
            }
          ]
        },
        "result": false
      },
      {
        "expression": {
          "type": "NotExpression",
          "children": [
            {
              "type": "NotExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "Zero"
                }
              ]
            }
          ]
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "one": 1,
      "two": 2,
      "three": 3
    },
    "cases": [
      {
        "expression": {
          "type": "Comparator",
          "name": "LT",
          "children": [
            {
              "type": "Field",
              "name": "one"
            },
            {
              "type": "Field",
              "name": "two"
            }
          ]
        },
        "result": true
      },
      {
        "expression": {
          "type": "Comparator",
          "name": "LTE",
          "children": [
            {
              "type": "Field",
              "name": "one"
            },
            {
              "type": "Field",
              "name": "two"
            }
          ]
        },
        "result": true
      },
      {
        "expression": {
          "type": "Comparator",
          "name": "EQ",
          "children": [
            {
              "type": "Field",
              "name": "one"
            },
            {
              "type": "Field",
              "name": "one"
            }
          ]
        },
        "result": true
      },
      {
        "expression": {
          "type": "Comparator",
          "name": "EQ",
          "children": [
            {
              "type": "Field",
              "name": "one"
            },
            {
              "type": "Field",
              "name": "two"
            }
          ]
        },
        "result": false
      },
      {
        "expression": {
          "type": "Comparator",
          "name": "GT",
          "children": [
            {
              "type": "Field",
              "name": "one"
            },
            {
              "type": "Field",
              "name": "two"
            }
          ]
        },
        "result": false
      },
      {
        "expression": {
          "type": "Comparator",
          "name": "GTE",
          "children": [
            {
              "type": "Field",
              "name": "one"
            },
            {
              "type": "Field",
              "name": "two"
            }
          ]
        },
        "result": false
      },
      {
        "expression": {
          "type": "Comparator",
          "name": "NE",
          "children": [
            {
              "type": "Field",
              "name": "one"
            },
            {
              "type": "Field",
              "name": "two"
            }
          ]
        },
        "result": true
      },
      {
        "expression": {
          "type": "AndExpression",
          "children": [
            {
              "type": "Comparator",
              "name": "LT",
              "children": [
                {
                  "type": "Field",
                  "name": "one"
                },
                {
                  "type": "Field",
                  "name": "two"
                }
              ]
            },
            {
              "type": "Comparator",
              "name": "GT",
              "children": [
                {
                  "type": "Field",
                  "name": "three"
                },
                {
                  "type": "Field",
                  "name": "one"
                }
              ]
            }
          ]
        },
        "result": true
      },
      {
        "expression": {
          "type": "OrExpression",
          "children": [
            {
              "type": "Comparator",
              "name": "LT",
              "children": [
                {
                  "type": "Field",
                  "name": "one"
                },
                {
                  "type": "Field",
                  "name": "two"
                }
              ]
            },
            {
              "type": "Comparator",
              "name": "GT",
              "children": [
                {
                  "type": "Field",
                  "name": "three"
                },
                {
                  "type": "Field",
                  "name": "one"
                }
              ]
            }
          ]
        },
        "result": true
      },
      {
        "expression": {
          "type": "OrExpression",
          "children": [
            {
              "type": "Comparator",
              "name": "LT",
              "children": [
                {
                  "type": "Field",
                  "name": "one"
                },
                {
                  "type": "Field",
                  "name": "two"
                }
              ]
            },
            {
              "type": "Comparator",
              "name": "LT",
              "children": [
                {
                  "type": "Field",
                  "name": "three"
                },
                {
                  "type": "Field",
                  "name": "one"
                }
              ]
            }
          ]
        },
        "result": true
      },
      {
        "expression": {
          "type": "OrExpression",
          "children": [
            {
              "type": "Comparator",
              "name": "LT",
              "children": [
                {
                  "type": "Field",
                  "name": "two"
                },
                {
                  "type": "Field",
                  "name": "one"
                }
              ]
            },
            {
              "type": "Comparator",
              "name": "LT",
              "children": [
                {
                  "type": "Field",
                  "name": "three"
                },
                {
                  "type": "Field",
                  "name": "one"
                }
              ]
            }
          ]
        },
        "result": false
      }
    ]
  },
  {
    "given": {
      "foo": [
        {
          "name": "a"
        },
        {
          "name": "b"
        }
      ],
      "bar": {
        "baz": "qux"
      }
    },
    "cases": [
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                }
              ]
            },
            {
              "type": "Field",
              "name": "name"
            }
          ]
        },
        "result": [
          "a",
          "b"
        ]
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Current"
                },
                {
                  "type": "Field",
                  "name": "bar"
                }
              ]
            },
            {
              "type": "Field",
              "name": "baz"
            }
          ]
        },
        "result": "qux"
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                }
              ]
            },
            {
              "type": "MultiSelectHash",
              "children": [
                {
                  "type": "KeyValuePair",
                  "name": "name",
                  "value": {
                    "type": "Field",
                    "name": "name"
                  }
                }
              ]
            }
          ]
        },
        "result": [
          {
            "name": "a"
          },
          {
            "name": "b"
          }
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                }
              ]
            },
            {
              "type": "MultiSelectHash",
              "children": [
                {
                  "type": "KeyValuePair",
                  "name": "#name",
                  "value": {
                    "type": "Field",
                    "name": "name"
                  }
                }
              ]
            }
          ]
        },
        "result": [
          {
            "#name": "a"
          },
          {
            "#name": "b"
          }
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                }
              ]
            },
            {
              "type": "Field",
              "name": "name"
            }
          ]
        },
        "result": [
          "a",
          "b"
        ]
      }
    ]
  },
  {
    "given": {
      "foo": [
        {
          "name": "a"
        },
        {
          "name": "b"
        }
      ],
      "bar": {
        "baz": "qux"
      }
    },
    "cases": [
      {
        "expression": {
          "type": "Current"
        },
        "result": {
          "foo": [
            {
              "name": "a"
            },
            {
              "name": "b"
            }
          ],
          "bar": {
            "baz": "qux"
          }
        }
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Current"
            },
            {
              "type": "Field",
              "name": "bar"
            }
          ]
        },
        "result": {
          "baz": "qux"
        }
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Current"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": {
          "name": "a"
        }
      }
    ]
  },
  {
    "given": {
      "foo.bar": "dot",
      "foo bar": "space",
      "foo\nbar": "newline",
      "foo\"bar": "doublequote",
      "c:\\\\windows\\path": "windows",
      "/unix/path": "unix",
      "\"\"\"": "threequotes",
      "bar": {
        "baz": "qux"
      }
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "foo.bar"
        },
        "result": "dot"
      },
      {
        "expression": {
          "type": "Field",
          "name": "foo bar"
        },
        "result": "space"
      },
      {
        "expression": {
          "type": "Field",
          "name": "foo\nbar"
        },
        "result": "newline"
      },
      {
        "expression": {
          "type": "Field",
          "name": "foo\"bar"
        },
        "result": "doublequote"
      },
      {
        "expression": {
          "type": "Field",
          "name": "c:\\\\windows\\path"
        },
        "result": "windows"
      },
      {
        "expression": {
          "type": "Field",
          "name": "/unix/path"
        },
        "result": "unix"
      },
      {
        "expression": {
          "type": "Field",
          "name": "\"\"\""
        },
        "result": "threequotes"
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "bar"
            },
            {
              "type": "Field",
              "name": "baz"
            }
          ]
        },
        "result": "qux"
      }
    ]
  },
  {
    "given": {
      "foo": [
        {
          "name": "a"
        },
        {
          "name": "b"
        }
      ]
    },
    "cases": [
      {
        "comment": "Matching a literal",
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Field",
                  "name": "name"
                },
                {
                  "type": "Literal",
                  "value": "a"
                }
              ]
            }
          ]
        },
        "result": [
          {
            "name": "a"
          }
        ]
      }
    ]
  },
  {
    "given": {
      "foo": [
        0,
        1
      ],
      "bar": [
        2,
        3
      ]
    },
    "cases": [
      {
        "comment": "Matching a literal",
        "expression": {
          "type": "ValueProjection",
          "children": [
            {
              "type": "Identity"
            },
            {
              "type": "FilterProjection",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Identity"
                },
                {
                  "type": "Comparator",
                  "name": "EQ",
                  "children": [
                    {
                      "type": "IndexExpression",
                      "children": [
                        {
                          "type": "Identity"
                        },
                        {
                          "type": "Index",
                          "value": 0
                        }
                      ]
                    },
                    {
                      "type": "Literal",
                      "value": 0
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          [],
          []
        ]
      }
    ]
  },
  {
    "given": {
      "foo": [
        {
          "first": "foo",
          "last": "bar"
        },
        {
          "first": "foo",
          "last": "foo"
        },
        {
          "first": "foo",
          "last": "baz"
        }
      ]
    },
    "cases": [
      {
        "comment": "Matching an expression",
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Field",
                  "name": "first"
                },
                {
                  "type": "Field",
                  "name": "last"
                }
              ]
            }
          ]
        },
        "result": [
          {
            "first": "foo",
            "last": "foo"
          }
        ]
      },
      {
        "comment": "Verify projection created from filter",
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Field",
              "name": "first"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Field",
                  "name": "first"
                },
                {
                  "type": "Field",
                  "name": "last"
                }
              ]
            }
          ]
        },
        "result": [
          "foo"
        ]
      }
    ]
  },
  {
    "given": {
      "foo": [
        {
          "age": 20
        },
        {
          "age": 25
        },
        {
          "age": 30
        }
      ]
    },
    "cases": [
      {
        "comment": "Greater than with a number",
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "GT",
              "children": [
                {
                  "type": "Field",
                  "name": "age"
                },
                {
                  "type": "Literal",
                  "value": 25
                }
              ]
            }
          ]
        },
        "result": [
          {
            "age": 30
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "GTE",
              "children": [
                {
                  "type": "Field",
                  "name": "age"
                },
                {
                  "type": "Literal",
                  "value": 25
                }
              ]
            }
          ]
        },
        "result": [
          {
            "age": 25
          },
          {
            "age": 30
          }
        ]
      },
      {
        "comment": "Greater than with a number",
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "GT",
              "children": [
                {
                  "type": "Field",
                  "name": "age"
                },
                {
                  "type": "Literal",
                  "value": 30
                }
              ]
            }
          ]
        },
        "result": []
      },
      {
        "comment": "Greater than with a number",
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "LT",
              "children": [
                {
                  "type": "Field",
                  "name": "age"
                },
                {
                  "type": "Literal",
                  "value": 25
                }
              ]
            }
          ]
        },
        "result": [
          {
            "age": 20
          }
        ]
      },
      {
        "comment": "Greater than with a number",
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "LTE",
              "children": [
                {
                  "type": "Field",
                  "name": "age"
                },
                {
                  "type": "Literal",
                  "value": 25
                }
              ]
            }
          ]
        },
        "result": [
          {
            "age": 20
          },
          {
            "age": 25
          }
        ]
      },
      {
        "comment": "Greater than with a number",
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "LT",
              "children": [
                {
                  "type": "Field",
                  "name": "age"
                },
                {
                  "type": "Literal",
                  "value": 20
                }
              ]
            }
          ]
        },
        "result": []
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Field",
                  "name": "age"
                },
                {
                  "type": "Literal",
                  "value": 20
                }
              ]
            }
          ]
        },
        "result": [
          {
            "age": 20
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "NE",
              "children": [
                {
                  "type": "Field",
                  "name": "age"
                },
                {
                  "type": "Literal",
                  "value": 20
                }
              ]
            }
          ]
        },
        "result": [
          {
            "age": 25
          },
          {
            "age": 30
          }
        ]
      }
    ]
  },
  {
    "given": {
      "foo": [
        {
          "top": {
            "name": "a"
          }
        },
        {
          "top": {
            "name": "b"
          }
        }
      ]
    },
    "cases": [
      {
        "comment": "Filter with subexpression",
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Subexpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "top"
                    },
                    {
                      "type": "Field",
                      "name": "name"
                    }
                  ]
                },
                {
                  "type": "Literal",
                  "value": "a"
                }
              ]
            }
          ]
        },
        "result": [
          {
            "top": {
              "name": "a"
            }
          }
        ]
      }
    ]
  },
  {
    "given": {
      "foo": [
        {
          "top": {
            "first": "foo",
            "last": "bar"
          }
        },
        {
          "top": {
            "first": "foo",
            "last": "foo"
          }
        },
        {
          "top": {
            "first": "foo",
            "last": "baz"
          }
        }
      ]
    },
    "cases": [
      {
        "comment": "Matching an expression",
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Subexpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "top"
                    },
                    {
                      "type": "Field",
                      "name": "first"
                    }
                  ]
                },
                {
                  "type": "Subexpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "top"
                    },
                    {
                      "type": "Field",
                      "name": "last"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          {
            "top": {
              "first": "foo",
              "last": "foo"
            }
          }
        ]
      },
      {
        "comment": "Matching a JSON array",
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Field",
                  "name": "top"
                },
                {
                  "type": "Literal",
                  "value": {
                    "first": "foo",
                    "last": "bar"
                  }
                }
              ]
            }
          ]
        },
        "result": [
          {
            "top": {
              "first": "foo",
              "last": "bar"
            }
          }
        ]
      }
    ]
  },
  {
    "given": {
      "foo": [
        {
          "key": true
        },
        {
          "key": false
        },
        {
          "key": 0
        },
        {
          "key": 1
        },
        {
          "key": [
            0
          ]
        },
        {
          "key": {
            "bar": [
              0
            ]
          }
        },
        {
          "key": null
        },
        {
          "key": [
            1
          ]
        },
        {
          "key": {
            "a": 2
          }
        }
      ]
    },
    "cases": [
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Field",
                  "name": "key"
                },
                {
                  "type": "Literal",
                  "value": true
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": true
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Field",
                  "name": "key"
                },
                {
                  "type": "Literal",
                  "value": false
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": false
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Field",
                  "name": "key"
                },
                {
                  "type": "Literal",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": 0
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Field",
                  "name": "key"
                },
                {
                  "type": "Literal",
                  "value": 1
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": 1
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Field",
                  "name": "key"
                },
                {
                  "type": "Literal",
                  "value": [
                    0
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": [
              0
            ]
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Field",
                  "name": "key"
                },
                {
                  "type": "Literal",
                  "value": {
                    "bar": [
                      0
                    ]
                  }
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": {
              "bar": [
                0
              ]
            }
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Field",
                  "name": "key"
                },
                {
                  "type": "Literal",
                  "value": null
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": null
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Field",
                  "name": "key"
                },
                {
                  "type": "Literal",
                  "value": [
                    1
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": [
              1
            ]
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Field",
                  "name": "key"
                },
                {
                  "type": "Literal",
                  "value": {
                    "a": 2
                  }
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": {
              "a": 2
            }
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Literal",
                  "value": true
                },
                {
                  "type": "Field",
                  "name": "key"
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": true
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Literal",
                  "value": false
                },
                {
                  "type": "Field",
                  "name": "key"
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": false
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Literal",
                  "value": 0
                },
                {
                  "type": "Field",
                  "name": "key"
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": 0
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Literal",
                  "value": 1
                },
                {
                  "type": "Field",
                  "name": "key"
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": 1
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Literal",
                  "value": [
                    0
                  ]
                },
                {
                  "type": "Field",
                  "name": "key"
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": [
              0
            ]
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Literal",
                  "value": {
                    "bar": [
                      0
                    ]
                  }
                },
                {
                  "type": "Field",
                  "name": "key"
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": {
              "bar": [
                0
              ]
            }
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Literal",
                  "value": null
                },
                {
                  "type": "Field",
                  "name": "key"
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": null
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Literal",
                  "value": [
                    1
                  ]
                },
                {
                  "type": "Field",
                  "name": "key"
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": [
              1
            ]
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Literal",
                  "value": {
                    "a": 2
                  }
                },
                {
                  "type": "Field",
                  "name": "key"
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": {
              "a": 2
            }
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "NE",
              "children": [
                {
                  "type": "Field",
                  "name": "key"
                },
                {
                  "type": "Literal",
                  "value": true
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": false
          },
          {
            "key": 0
          },
          {
            "key": 1
          },
          {
            "key": [
              0
            ]
          },
          {
            "key": {
              "bar": [
                0
              ]
            }
          },
          {
            "key": null
          },
          {
            "key": [
              1
            ]
          },
          {
            "key": {
              "a": 2
            }
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "NE",
              "children": [
                {
                  "type": "Field",
                  "name": "key"
                },
                {
                  "type": "Literal",
                  "value": false
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": true
          },
          {
            "key": 0
          },
          {
            "key": 1
          },
          {
            "key": [
              0
            ]
          },
          {
            "key": {
              "bar": [
                0
              ]
            }
          },
          {
            "key": null
          },
          {
            "key": [
              1
            ]
          },
          {
            "key": {
              "a": 2
            }
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "NE",
              "children": [
                {
                  "type": "Field",
                  "name": "key"
                },
                {
                  "type": "Literal",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": true
          },
          {
            "key": false
          },
          {
            "key": 1
          },
          {
            "key": [
              0
            ]
          },
          {
            "key": {
              "bar": [
                0
              ]
            }
          },
          {
            "key": null
          },
          {
            "key": [
              1
            ]
          },
          {
            "key": {
              "a": 2
            }
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "NE",
              "children": [
                {
                  "type": "Field",
                  "name": "key"
                },
                {
                  "type": "Literal",
                  "value": 1
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": true
          },
          {
            "key": false
          },
          {
            "key": 0
          },
          {
            "key": [
              0
            ]
          },
          {
            "key": {
              "bar": [
                0
              ]
            }
          },
          {
            "key": null
          },
          {
            "key": [
              1
            ]
          },
          {
            "key": {
              "a": 2
            }
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "NE",
              "children": [
                {
                  "type": "Field",
                  "name": "key"
                },
                {
                  "type": "Literal",
                  "value": null
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": true
          },
          {
            "key": false
          },
          {
            "key": 0
          },
          {
            "key": 1
          },
          {
            "key": [
              0
            ]
          },
          {
            "key": {
              "bar": [
                0
              ]
            }
          },
          {
            "key": [
              1
            ]
          },
          {
            "key": {
              "a": 2
            }
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "NE",
              "children": [
                {
                  "type": "Field",
                  "name": "key"
                },
                {
                  "type": "Literal",
                  "value": [
                    1
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": true
          },
          {
            "key": false
          },
          {
            "key": 0
          },
          {
            "key": 1
          },
          {
            "key": [
              0
            ]
          },
          {
            "key": {
              "bar": [
                0
              ]
            }
          },
          {
            "key": null
          },
          {
            "key": {
              "a": 2
            }
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "NE",
              "children": [
                {
                  "type": "Field",
                  "name": "key"
                },
                {
                  "type": "Literal",
                  "value": {
                    "a": 2
                  }
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": true
          },
          {
            "key": false
          },
          {
            "key": 0
          },
          {
            "key": 1
          },
          {
            "key": [
              0
            ]
          },
          {
            "key": {
              "bar": [
                0
              ]
            }
          },
          {
            "key": null
          },
          {
            "key": [
              1
            ]
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "NE",
              "children": [
                {
                  "type": "Literal",
                  "value": true
                },
                {
                  "type": "Field",
                  "name": "key"
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": false
          },
          {
            "key": 0
          },
          {
            "key": 1
          },
          {
            "key": [
              0
            ]
          },
          {
            "key": {
              "bar": [
                0
              ]
            }
          },
          {
            "key": null
          },
          {
            "key": [
              1
            ]
          },
          {
            "key": {
              "a": 2
            }
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "NE",
              "children": [
                {
                  "type": "Literal",
                  "value": false
                },
                {
                  "type": "Field",
                  "name": "key"
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": true
          },
          {
            "key": 0
          },
          {
            "key": 1
          },
          {
            "key": [
              0
            ]
          },
          {
            "key": {
              "bar": [
                0
              ]
            }
          },
          {
            "key": null
          },
          {
            "key": [
              1
            ]
          },
          {
            "key": {
              "a": 2
            }
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "NE",
              "children": [
                {
                  "type": "Literal",
                  "value": 0
                },
                {
                  "type": "Field",
                  "name": "key"
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": true
          },
          {
            "key": false
          },
          {
            "key": 1
          },
          {
            "key": [
              0
            ]
          },
          {
            "key": {
              "bar": [
                0
              ]
            }
          },
          {
            "key": null
          },
          {
            "key": [
              1
            ]
          },
          {
            "key": {
              "a": 2
            }
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "NE",
              "children": [
                {
                  "type": "Literal",
                  "value": 1
                },
                {
                  "type": "Field",
                  "name": "key"
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": true
          },
          {
            "key": false
          },
          {
            "key": 0
          },
          {
            "key": [
              0
            ]
          },
          {
            "key": {
              "bar": [
                0
              ]
            }
          },
          {
            "key": null
          },
          {
            "key": [
              1
            ]
          },
          {
            "key": {
              "a": 2
            }
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "NE",
              "children": [
                {
                  "type": "Literal",
                  "value": null
                },
                {
                  "type": "Field",
                  "name": "key"
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": true
          },
          {
            "key": false
          },
          {
            "key": 0
          },
          {
            "key": 1
          },
          {
            "key": [
              0
            ]
          },
          {
            "key": {
              "bar": [
                0
              ]
            }
          },
          {
            "key": [
              1
            ]
          },
          {
            "key": {
              "a": 2
            }
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "NE",
              "children": [
                {
                  "type": "Literal",
                  "value": [
                    1
                  ]
                },
                {
                  "type": "Field",
                  "name": "key"
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": true
          },
          {
            "key": false
          },
          {
            "key": 0
          },
          {
            "key": 1
          },
          {
            "key": [
              0
            ]
          },
          {
            "key": {
              "bar": [
                0
              ]
            }
          },
          {
            "key": null
          },
          {
            "key": {
              "a": 2
            }
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "NE",
              "children": [
                {
                  "type": "Literal",
                  "value": {
                    "a": 2
                  }
                },
                {
                  "type": "Field",
                  "name": "key"
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": true
          },
          {
            "key": false
          },
          {
            "key": 0
          },
          {
            "key": 1
          },
          {
            "key": [
              0
            ]
          },
          {
            "key": {
              "bar": [
                0
              ]
            }
          },
          {
            "key": null
          },
          {
            "key": [
              1
            ]
          }
        ]
      }
    ]
  },
  {
    "given": {
      "reservations": [
        {
          "instances": [
            {
              "foo": 1,
              "bar": 2
            },
            {
              "foo": 1,
              "bar": 3
            },
            {
              "foo": 1,
              "bar": 2
            },
            {
              "foo": 2,
              "bar": 1
            }
          ]
        }
      ]
    },
    "cases": [
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Field",
                  "name": "reservations"
                }
              ]
            },
            {
              "type": "FilterProjection",
              "children": [
                {
                  "type": "Field",
                  "name": "instances"
                },
                {
                  "type": "Identity"
                },
                {
                  "type": "Comparator",
                  "name": "EQ",
                  "children": [
                    {
                      "type": "Field",
                      "name": "bar"
                    },
                    {
                      "type": "Literal",
                      "value": 1
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          [
            {
              "foo": 2,
              "bar": 1
            }
          ]
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "reservations"
            },
            {
              "type": "FilterProjection",
              "children": [
                {
                  "type": "Field",
                  "name": "instances"
                },
                {
                  "type": "Identity"
                },
                {
                  "type": "Comparator",
                  "name": "EQ",
                  "children": [
                    {
                      "type": "Field",
                      "name": "bar"
                    },
                    {
                      "type": "Literal",
                      "value": 1
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          [
            {
              "foo": 2,
              "bar": 1
            }
          ]
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Projection",
                  "children": [
                    {
                      "type": "Flatten",
                      "children": [
                        {
                          "type": "Field",
                          "name": "reservations"
                        }
                      ]
                    },
                    {
                      "type": "FilterProjection",
                      "children": [
                        {
                          "type": "Field",
                          "name": "instances"
                        },
                        {
                          "type": "Identity"
                        },
                        {
                          "type": "Comparator",
                          "name": "EQ",
                          "children": [
                            {
                              "type": "Field",
                              "name": "bar"
                            },
                            {
                              "type": "Literal",
                              "value": 1
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          {
            "foo": 2,
            "bar": 1
          }
        ]
      }
    ]
  },
  {
    "given": {
      "baz": "other",
      "foo": [
        {
          "bar": 1
        },
        {
          "bar": 2
        },
        {
          "bar": 3
        },
        {
          "bar": 4
        },
        {
          "bar": 1,
          "baz": 2
        }
      ]
    },
    "cases": [
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Literal",
                  "value": 1
                }
              ]
            }
          ]
        },
        "result": []
      }
    ]
  },
  {
    "given": {
      "foo": [
        {
          "a": 1,
          "b": {
            "c": "x"
          }
        },
        {
          "a": 1,
          "b": {
            "c": "y"
          }
        },
        {
          "a": 1,
          "b": {
            "c": "z"
          }
        },
        {
          "a": 2,
          "b": {
            "c": "z"
          }
        },
        {
          "a": 1,
          "baz": 2
        }
      ]
    },
    "cases": [
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "b"
                },
                {
                  "type": "Field",
                  "name": "c"
                }
              ]
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Field",
                  "name": "a"
                },
                {
                  "type": "Literal",
                  "value": 1
                }
              ]
            }
          ]
        },
        "result": [
          "x",
          "y",
          "z"
        ]
      }
    ]
  },
  {
    "given": {
      "foo": [
        {
          "name": "a"
        },
        {
          "name": "b"
        },
        {
          "name": "c"
        }
      ]
    },
    "cases": [
      {
        "comment": "Filter with or expression",
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "OrExpression",
              "children": [
                {
                  "type": "Comparator",
                  "name": "EQ",
                  "children": [
                    {
                      "type": "Field",
                      "name": "name"
                    },
                    {
                      "type": "Literal",
                      "value": "a"
                    }
                  ]
                },
                {
                  "type": "Comparator",
                  "name": "EQ",
                  "children": [
                    {
                      "type": "Field",
                      "name": "name"
                    },
                    {
                      "type": "Literal",
                      "value": "b"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          {
            "name": "a"
          },
          {
            "name": "b"
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "OrExpression",
              "children": [
                {
                  "type": "Comparator",
                  "name": "EQ",
                  "children": [
                    {
                      "type": "Field",
                      "name": "name"
                    },
                    {
                      "type": "Literal",
                      "value": "a"
                    }
                  ]
                },
                {
                  "type": "Comparator",
                  "name": "EQ",
                  "children": [
                    {
                      "type": "Field",
                      "name": "name"
                    },
                    {
                      "type": "Literal",
                      "value": "e"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          {
            "name": "a"
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "OrExpression",
              "children": [
                {
                  "type": "OrExpression",
                  "children": [
                    {
                      "type": "Comparator",
                      "name": "EQ",
                      "children": [
                        {
                          "type": "Field",
                          "name": "name"
                        },
                        {
                          "type": "Literal",
                          "value": "a"
                        }
                      ]
                    },
                    {
                      "type": "Comparator",
                      "name": "EQ",
                      "children": [
                        {
                          "type": "Field",
                          "name": "name"
                        },
                        {
                          "type": "Literal",
                          "value": "b"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "Comparator",
                  "name": "EQ",
                  "children": [
                    {
                      "type": "Field",
                      "name": "name"
                    },
                    {
                      "type": "Literal",
                      "value": "c"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          {
            "name": "a"
          },
          {
            "name": "b"
          },
          {
            "name": "c"
          }
        ]
      }
    ]
  },
  {
    "given": {
      "foo": [
        {
          "a": 1,
          "b": 2
        },
        {
          "a": 1,
          "b": 3
        }
      ]
    },
    "cases": [
      {
        "comment": "Filter with and expression",
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "AndExpression",
              "children": [
                {
                  "type": "Comparator",
                  "name": "EQ",
                  "children": [
                    {
                      "type": "Field",
                      "name": "a"
                    },
                    {
                      "type": "Literal",
                      "value": 1
                    }
                  ]
                },
                {
                  "type": "Comparator",
                  "name": "EQ",
                  "children": [
                    {
                      "type": "Field",
                      "name": "b"
                    },
                    {
                      "type": "Literal",
                      "value": 2
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          {
            "a": 1,
            "b": 2
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "AndExpression",
              "children": [
                {
                  "type": "Comparator",
                  "name": "EQ",
                  "children": [
                    {
                      "type": "Field",
                      "name": "a"
                    },
                    {
                      "type": "Literal",
                      "value": 1
                    }
                  ]
                },
                {
                  "type": "Comparator",
                  "name": "EQ",
                  "children": [
                    {
                      "type": "Field",
                      "name": "b"
                    },
                    {
                      "type": "Literal",
                      "value": 4
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": []
      }
    ]
  },
  {
    "given": {
      "foo": [
        {
          "a": 1,
          "b": 2,
          "c": 3
        },
        {
          "a": 3,
          "b": 4
        }
      ]
    },
    "cases": [
      {
        "comment": "Filter with Or and And expressions",
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "OrExpression",
              "children": [
                {
                  "type": "Comparator",
                  "name": "EQ",
                  "children": [
                    {
                      "type": "Field",
                      "name": "c"
                    },
                    {
                      "type": "Literal",
                      "value": 3
                    }
                  ]
                },
                {
                  "type": "AndExpression",
                  "children": [
                    {
                      "type": "Comparator",
                      "name": "EQ",
                      "children": [
                        {
                          "type": "Field",
                          "name": "a"
                        },
                        {
                          "type": "Literal",
                          "value": 1
                        }
                      ]
                    },
                    {
                      "type": "Comparator",
                      "name": "EQ",
                      "children": [
                        {
                          "type": "Field",
                          "name": "b"
                        },
                        {
                          "type": "Literal",
                          "value": 4
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          {
            "a": 1,
            "b": 2,
            "c": 3
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "OrExpression",
              "children": [
                {
                  "type": "Comparator",
                  "name": "EQ",
                  "children": [
                    {
                      "type": "Field",
                      "name": "b"
                    },
                    {
                      "type": "Literal",
                      "value": 2
                    }
                  ]
                },
                {
                  "type": "AndExpression",
                  "children": [
                    {
                      "type": "Comparator",
                      "name": "EQ",
                      "children": [
                        {
                          "type": "Field",
                          "name": "a"
                        },
                        {
                          "type": "Literal",
                          "value": 3
                        }
                      ]
                    },
                    {
                      "type": "Comparator",
                      "name": "EQ",
                      "children": [
                        {
                          "type": "Field",
                          "name": "b"
                        },
                        {
                          "type": "Literal",
                          "value": 4
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          {
            "a": 1,
            "b": 2,
            "c": 3
          },
          {
            "a": 3,
            "b": 4
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "OrExpression",
              "children": [
                {
                  "type": "AndExpression",
                  "children": [
                    {
                      "type": "Comparator",
                      "name": "EQ",
                      "children": [
                        {
                          "type": "Field",
                          "name": "a"
                        },
                        {
                          "type": "Literal",
                          "value": 3
                        }
                      ]
                    },
                    {
                      "type": "Comparator",
                      "name": "EQ",
                      "children": [
                        {
                          "type": "Field",
                          "name": "b"
                        },
                        {
                          "type": "Literal",
                          "value": 4
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "Comparator",
                  "name": "EQ",
                  "children": [
                    {
                      "type": "Field",
                      "name": "b"
                    },
                    {
                      "type": "Literal",
                      "value": 2
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          {
            "a": 1,
            "b": 2,
            "c": 3
          },
          {
            "a": 3,
            "b": 4
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "OrExpression",
              "children": [
                {
                  "type": "AndExpression",
                  "children": [
                    {
                      "type": "Comparator",
                      "name": "EQ",
                      "children": [
                        {
                          "type": "Field",
                          "name": "a"
                        },
                        {
                          "type": "Literal",
                          "value": 3
                        }
                      ]
                    },
                    {
                      "type": "Comparator",
                      "name": "EQ",
                      "children": [
                        {
                          "type": "Field",
                          "name": "b"
                        },
                        {
                          "type": "Literal",
                          "value": 4
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "Comparator",
                  "name": "EQ",
                  "children": [
                    {
                      "type": "Field",
                      "name": "b"
                    },
                    {
                      "type": "Literal",
                      "value": 2
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          {
            "a": 1,
            "b": 2,
            "c": 3
          },
          {
            "a": 3,
            "b": 4
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "OrExpression",
              "children": [
                {
                  "type": "AndExpression",
                  "children": [
                    {
                      "type": "Comparator",
                      "name": "EQ",
                      "children": [
                        {
                          "type": "Field",
                          "name": "a"
                        },
                        {
                          "type": "Literal",
                          "value": 3
                        }
                      ]
                    },
                    {
                      "type": "Comparator",
                      "name": "EQ",
                      "children": [
                        {
                          "type": "Field",
                          "name": "b"
                        },
                        {
                          "type": "Literal",
                          "value": 4
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "Comparator",
                  "name": "EQ",
                  "children": [
                    {
                      "type": "Field",
                      "name": "b"
                    },
                    {
                      "type": "Literal",
                      "value": 2
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          {
            "a": 1,
            "b": 2,
            "c": 3
          },
          {
            "a": 3,
            "b": 4
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "AndExpression",
              "children": [
                {
                  "type": "Comparator",
                  "name": "EQ",
                  "children": [
                    {
                      "type": "Field",
                      "name": "a"
                    },
                    {
                      "type": "Literal",
                      "value": 3
                    }
                  ]
                },
                {
                  "type": "OrExpression",
                  "children": [
                    {
                      "type": "Comparator",
                      "name": "EQ",
                      "children": [
                        {
                          "type": "Field",
                          "name": "b"
                        },
                        {
                          "type": "Literal",
                          "value": 4
                        }
                      ]
                    },
                    {
                      "type": "Comparator",
                      "name": "EQ",
                      "children": [
                        {
                          "type": "Field",
                          "name": "b"
                        },
                        {
                          "type": "Literal",
                          "value": 2
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          {
            "a": 3,
            "b": 4
          }
        ]
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "AndExpression",
              "children": [
                {
                  "type": "Comparator",
                  "name": "EQ",
                  "children": [
                    {
                      "type": "Field",
                      "name": "a"
                    },
                    {
                      "type": "Literal",
                      "value": 3
                    }
                  ]
                },
                {
                  "type": "OrExpression",
                  "children": [
                    {
                      "type": "Comparator",
                      "name": "EQ",
                      "children": [
                        {
                          "type": "Field",
                          "name": "b"
                        },
                        {
                          "type": "Literal",
                          "value": 4
                        }
                      ]
                    },
                    {
                      "type": "Comparator",
                      "name": "EQ",
                      "children": [
                        {
                          "type": "Field",
                          "name": "b"
                        },
                        {
                          "type": "Literal",
                          "value": 2
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          {
            "a": 3,
            "b": 4
          }
        ]
      }
    ]
  },
  {
    "given": {
      "foo": [
        {
          "a": 1,
          "b": 2,
          "c": 3
        },
        {
          "a": 3,
          "b": 4
        }
      ]
    },
    "cases": [
      {
        "comment": "Verify precedence of or/and expressions",
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "OrExpression",
              "children": [
                {
                  "type": "Comparator",
                  "name": "EQ",
                  "children": [
                    {
                      "type": "Field",
                      "name": "a"
                    },
                    {
                      "type": "Literal",
                      "value": 1
                    }
                  ]
                },
                {
                  "type": "AndExpression",
                  "children": [
                    {
                      "type": "Comparator",
                      "name": "EQ",
                      "children": [
                        {
                          "type": "Field",
                          "name": "b"
                        },
                        {
                          "type": "Literal",
                          "value": 2
                        }
                      ]
                    },
                    {
                      "type": "Comparator",
                      "name": "EQ",
                      "children": [
                        {
                          "type": "Field",
                          "name": "c"
                        },
                        {
                          "type": "Literal",
                          "value": 5
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          {
            "a": 1,
            "b": 2,
            "c": 3
          }
        ]
      },
      {
        "comment": "Parentheses can alter precedence",
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "AndExpression",
              "children": [
                {
                  "type": "OrExpression",
                  "children": [
                    {
                      "type": "Comparator",
                      "name": "EQ",
                      "children": [
                        {
                          "type": "Field",
                          "name": "a"
                        },
                        {
                          "type": "Literal",
                          "value": 1
                        }
                      ]
                    },
                    {
                      "type": "Comparator",
                      "name": "EQ",
                      "children": [
                        {
                          "type": "Field",
                          "name": "b"
                        },
                        {
                          "type": "Literal",
                          "value": 2
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "Comparator",
                  "name": "EQ",
                  "children": [
                    {
                      "type": "Field",
                      "name": "c"
                    },
                    {
                      "type": "Literal",
                      "value": 5
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": []
      },
      {
        "comment": "Not expressions combined with and/or",
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "NotExpression",
              "children": [
                {
                  "type": "OrExpression",
                  "children": [
                    {
                      "type": "Comparator",
                      "name": "EQ",
                      "children": [
                        {
                          "type": "Field",
                          "name": "a"
                        },
                        {
                          "type": "Literal",
                          "value": 1
                        }
                      ]
                    },
                    {
                      "type": "Comparator",
                      "name": "EQ",
                      "children": [
                        {
                          "type": "Field",
                          "name": "b"
                        },
                        {
                          "type": "Literal",
                          "value": 2
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          {
            "a": 3,
            "b": 4
          }
        ]
      }
    ]
  },
  {
    "given": {
      "foo": [
        {
          "key": true
        },
        {
          "key": false
        },
        {
          "key": []
        },
        {
          "key": {}
        },
        {
          "key": [
            0
          ]
        },
        {
          "key": {
            "a": "b"
          }
        },
        {
          "key": 0
        },
        {
          "key": 1
        },
        {
          "key": null
        },
        {
          "notkey": true
        }
      ]
    },
    "cases": [
      {
        "comment": "Unary filter expression",
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Field",
              "name": "key"
            }
          ]
        },
        "result": [
          {
            "key": true
          },
          {
            "key": [
              0
            ]
          },
          {
            "key": {
              "a": "b"
            }
          },
          {
            "key": 0
          },
          {
            "key": 1
          }
        ]
      },
      {
        "comment": "Unary not filter expression",
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "NotExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "key"
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": false
          },
          {
            "key": []
          },
          {
            "key": {}
          },
          {
            "key": null
          },
          {
            "notkey": true
          }
        ]
      },
      {
        "comment": "Equality with null RHS",
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Field",
                  "name": "key"
                },
                {
                  "type": "Literal",
                  "value": null
                }
              ]
            }
          ]
        },
        "result": [
          {
            "key": null
          },
          {
            "notkey": true
          }
        ]
      }
    ]
  },
  {
    "given": {
      "foo": [
        0,
        1,
        2,
        3,
        4,
        5,
        6,
        7,
        8,
        9
      ]
    },
    "cases": [
      {
        "comment": "Using @ in a filter expression",
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "LT",
              "children": [
                {
                  "type": "Current"
                },
                {
                  "type": "Literal",
                  "value": 5
                }
              ]
            }
          ]
        },
        "result": [
          0,
          1,
          2,
          3,
          4
        ]
      },
      {
        "comment": "Using @ in a filter expression",
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "GT",
              "children": [
                {
                  "type": "Literal",
                  "value": 5
                },
                {
                  "type": "Current"
                }
              ]
            }
          ]
        },
        "result": [
          0,
          1,
          2,
          3,
          4
        ]
      },
      {
        "comment": "Using @ in a filter expression",
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Current"
                },
                {
                  "type": "Current"
                }
              ]
            }
          ]
        },
        "result": [
          0,
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9
        ]
      }
    ]
  },
  {
    "given": {
      "foo": -1,
      "zero": 0,
      "numbers": [
        -1,
        3,
        4,
        5
      ],
      "array": [
        -1,
        3,
        4,
        5,
        "a",
        "100"
      ],
      "strings": [
        "a",
        "b",
        "c"
      ],
      "decimals": [
        1.01,
        1.2,
        -1.5
      ],
      "str": "Str",
      "false": false,
      "empty_list": [],
      "empty_hash": {},
      "objects": {
        "foo": "bar",
        "bar": "baz"
      },
      "null_key": null
    },
    "cases": [
      {
        "expression": {
          "type": "Function",
          "name": "abs",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            }
          ]
        },
        "result": 1
      },
      {
        "expression": {
          "type": "Function",
          "name": "abs",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            }
          ]
        },
        "result": 1
      },
      {
        "expression": {
          "type": "Function",
          "name": "abs",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "array"
                },
                {
                  "type": "Index",
                  "value": 1
                }
              ]
            }
          ]
        },
        "result": 3
      },
      {
        "expression": {
          "type": "Function",
          "name": "abs",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "array"
                },
                {
                  "type": "Index",
                  "value": 1
                }
              ]
            }
          ]
        },
        "result": 3
      },
      {
        "expression": {
          "type": "Function",
          "name": "abs",
          "children": [
            {
              "type": "Literal",
              "value": -24
            }
          ]
        },
        "result": 24
      },
      {
        "expression": {
          "type": "Function",
          "name": "abs",
          "children": [
            {
              "type": "Literal",
              "value": -24
            }
          ]
        },
        "result": 24
      },
      {
        "expression": {
          "type": "Function",
          "name": "avg",
          "children": [
            {
              "type": "Field",
              "name": "numbers"
            }
          ]
        },
        "result": 2.75
      },
      {
        "expression": {
          "type": "Function",
          "name": "ceil",
          "children": [
            {
              "type": "Literal",
              "value": 1.2
            }
          ]
        },
        "result": 2
      },
      {
        "expression": {
          "type": "Function",
          "name": "ceil",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "decimals"
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": 2
      },
      {
        "expression": {
          "type": "Function",
          "name": "ceil",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "decimals"
                },
                {
                  "type": "Index",
                  "value": 1
                }
              ]
            }
          ]
        },
        "result": 2
      },
      {
        "expression": {
          "type": "Function",
          "name": "ceil",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "decimals"
                },
                {
                  "type": "Index",
                  "value": 2
                }
              ]
            }
          ]
        },
        "result": -1
      },
      {
        "expression": {
          "type": "Function",
          "name": "contains",
          "children": [
            {
              "type": "Literal",
              "value": "abc"
            },
            {
              "type": "Literal",
              "value": "a"
            }
          ]
        },
        "result": true
      },
      {
        "expression": {
          "type": "Function",
          "name": "contains",
          "children": [
            {
              "type": "Literal",
              "value": "abc"
            },
            {
              "type": "Literal",
              "value": "d"
            }
          ]
        },
        "result": false
      },
      {
        "expression": {
          "type": "Function",
          "name": "contains",
          "children": [
            {
              "type": "Field",
              "name": "strings"
            },
            {
              "type": "Literal",
              "value": "a"
            }
          ]
        },
        "result": true
      },
      {
        "expression": {
          "type": "Function",
          "name": "contains",
          "children": [
            {
              "type": "Field",
              "name": "decimals"
            },
            {
              "type": "Literal",
              "value": 1.2
            }
          ]
        },
        "result": true
      },
      {
        "expression": {
          "type": "Function",
          "name": "contains",
          "children": [
            {
              "type": "Field",
              "name": "decimals"
            },
            {
              "type": "Literal",
              "value": false
            }
          ]
        },
        "result": false
      },
      {
        "expression": {
          "type": "Function",
          "name": "ends_with",
          "children": [
            {
              "type": "Field",
              "name": "str"
            },
            {
              "type": "Literal",
              "value": "r"
            }
          ]
        },
        "result": true
      },
      {
        "expression": {
          "type": "Function",
          "name": "ends_with",
          "children": [
            {
              "type": "Field",
              "name": "str"
            },
            {
              "type": "Literal",
              "value": "tr"
            }
          ]
        },
        "result": true
      },
      {
        "expression": {
          "type": "Function",
          "name": "ends_with",
          "children": [
            {
              "type": "Field",
              "name": "str"
            },
            {
              "type": "Literal",
              "value": "Str"
            }
          ]
        },
        "result": true
      },
      {
        "expression": {
          "type": "Function",
          "name": "ends_with",
          "children": [
            {
              "type": "Field",
              "name": "str"
            },
            {
              "type": "Literal",
              "value": "SStr"
            }
          ]
        },
        "result": false
      },
      {
        "expression": {
          "type": "Function",
          "name": "ends_with",
          "children": [
            {
              "type": "Field",
              "name": "str"
            },
            {
              "type": "Literal",
              "value": "foo"
            }
          ]
        },
        "result": false
      },
      {
        "expression": {
          "type": "Function",
          "name": "floor",
          "children": [
            {
              "type": "Literal",
              "value": 1.2
            }
          ]
        },
        "result": 1
      },
      {
        "expression": {
          "type": "Function",
          "name": "floor",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "decimals"
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": 1
      },
      {
        "expression": {
          "type": "Function",
          "name": "floor",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            }
          ]
        },
        "result": -1
      },
      {
        "expression": {
          "type": "Function",
          "name": "length",
          "children": [
            {
              "type": "Literal",
              "value": "abc"
            }
          ]
        },
        "result": 3
      },
      {
        "expression": {
          "type": "Function",
          "name": "length",
          "children": [
            {
              "type": "Literal",
              "value": "✓foo"
            }
          ]
        },
        "result": 4
      },
      {
        "expression": {
          "type": "Function",
          "name": "length",
          "children": [
            {
              "type": "Literal",
              "value": ""
            }
          ]
        },
        "result": 0
      },
      {
        "expression": {
          "type": "Function",
          "name": "length",
          "children": [
            {
              "type": "Current"
            }
          ]
        },
        "result": 12
      },
      {
        "expression": {
          "type": "Function",
          "name": "length",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "strings"
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": 1
      },
      {
        "expression": {
          "type": "Function",
          "name": "length",
          "children": [
            {
              "type": "Field",
              "name": "str"
            }
          ]
        },
        "result": 3
      },
      {
        "expression": {
          "type": "Function",
          "name": "length",
          "children": [
            {
              "type": "Field",
              "name": "array"
            }
          ]
        },
        "result": 6
      },
      {
        "expression": {
          "type": "Function",
          "name": "length",
          "children": [
            {
              "type": "Field",
              "name": "objects"
            }
          ]
        },
        "result": 2
      },
      {
        "expression": {
          "type": "Function",
          "name": "length",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "strings"
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": 1
      },
      {
        "expression": {
          "type": "Function",
          "name": "max",
          "children": [
            {
              "type": "Field",
              "name": "numbers"
            }
          ]
        },
        "result": 5
      },
      {
        "expression": {
          "type": "Function",
          "name": "max",
          "children": [
            {
              "type": "Field",
              "name": "decimals"
            }
          ]
        },
        "result": 1.2
      },
      {
        "expression": {
          "type": "Function",
          "name": "max",
          "children": [
            {
              "type": "Field",
              "name": "strings"
            }
          ]
        },
        "result": "c"
      },
      {
        "expression": {
          "type": "Function",
          "name": "max",
          "children": [
            {
              "type": "Field",
              "name": "decimals"
            }
          ]
        },
        "result": 1.2
      },
      {
        "expression": {
          "type": "Function",
          "name": "max",
          "children": [
            {
              "type": "Field",
              "name": "empty_list"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Function",
          "name": "merge",
          "children": [
            {
              "type": "Literal",
              "value": {}
            }
          ]
        },
        "result": {}
      },
      {
        "expression": {
          "type": "Function",
          "name": "merge",
          "children": [
            {
              "type": "Literal",
              "value": {}
            },
            {
              "type": "Literal",
              "value": {}
            }
          ]
        },
        "result": {}
      },
      {
        "expression": {
          "type": "Function",
          "name": "merge",
          "children": [
            {
              "type": "Literal",
              "value": {
                "a": 1
              }
            },
            {
              "type": "Literal",
              "value": {
                "b": 2
              }
            }
          ]
        },
        "result": {
          "a": 1,
          "b": 2
        }
      },
      {
        "expression": {
          "type": "Function",
          "name": "merge",
          "children": [
            {
              "type": "Literal",
              "value": {
                "a": 1
              }
            },
            {
              "type": "Literal",
              "value": {
                "a": 2
              }
            }
          ]
        },
        "result": {
          "a": 2
        }
      },
      {
        "expression": {
          "type": "Function",
          "name": "merge",
          "children": [
            {
              "type": "Literal",
              "value": {
                "a": 1,
                "b": 2
              }
            },
            {
              "type": "Literal",
              "value": {
                "a": 2,
                "c": 3
              }
            },
            {
              "type": "Literal",
              "value": {
                "d": 4
              }
            }
          ]
        },
        "result": {
          "a": 2,
          "b": 2,
          "c": 3,
          "d": 4
        }
      },
      {
        "expression": {
          "type": "Function",
          "name": "min",
          "children": [
            {
              "type": "Field",
              "name": "numbers"
            }
          ]
        },
        "result": -1
      },
      {
        "expression": {
          "type": "Function",
          "name": "min",
          "children": [
            {
              "type": "Field",
              "name": "decimals"
            }
          ]
        },
        "result": -1.5
      },
      {
        "expression": {
          "type": "Function",
          "name": "min",
          "children": [
            {
              "type": "Field",
              "name": "empty_list"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Function",
          "name": "min",
          "children": [
            {
              "type": "Field",
              "name": "decimals"
            }
          ]
        },
        "result": -1.5
      },
      {
        "expression": {
          "type": "Function",
          "name": "min",
          "children": [
            {
              "type": "Field",
              "name": "strings"
            }
          ]
        },
        "result": "a"
      },
      {
        "expression": {
          "type": "Function",
          "name": "type",
          "children": [
            {
              "type": "Literal",
              "value": "abc"
            }
          ]
        },
        "result": "string"
      },
      {
        "expression": {
          "type": "Function",
          "name": "type",
          "children": [
            {
              "type": "Literal",
              "value": 1
            }
          ]
        },
        "result": "number"
      },
      {
        "expression": {
          "type": "Function",
          "name": "type",
          "children": [
            {
              "type": "Literal",
              "value": 2
            }
          ]
        },
        "result": "number"
      },
      {
        "expression": {
          "type": "Function",
          "name": "type",
          "children": [
            {
              "type": "Literal",
              "value": true
            }
          ]
        },
        "result": "boolean"
      },
      {
        "expression": {
          "type": "Function",
          "name": "type",
          "children": [
            {
              "type": "Literal",
              "value": false
            }
          ]
        },
        "result": "boolean"
      },
      {
        "expression": {
          "type": "Function",
          "name": "type",
          "children": [
            {
              "type": "Literal",
              "value": null
            }
          ]
        },
        "result": "null"
      },
      {
        "expression": {
          "type": "Function",
          "name": "type",
          "children": [
            {
              "type": "Literal",
              "value": [
                0
              ]
            }
          ]
        },
        "result": "array"
      },
      {
        "expression": {
          "type": "Function",
          "name": "type",
          "children": [
            {
              "type": "Literal",
              "value": {
                "a": "b"
              }
            }
          ]
        },
        "result": "object"
      },
      {
        "expression": {
          "type": "Function",
          "name": "type",
          "children": [
            {
              "type": "Current"
            }
          ]
        },
        "result": "object"
      },
      {
        "expression": {
          "type": "Function",
          "name": "sort",
          "children": [
            {
              "type": "Function",
              "name": "keys",
              "children": [
                {
                  "type": "Field",
                  "name": "objects"
                }
              ]
            }
          ]
        },
        "result": [
          "bar",
          "foo"
        ]
      },
      {
        "expression": {
          "type": "Function",
          "name": "sort",
          "children": [
            {
              "type": "Function",
              "name": "values",
              "children": [
                {
                  "type": "Field",
                  "name": "objects"
                }
              ]
            }
          ]
        },
        "result": [
          "bar",
          "baz"
        ]
      },
      {
        "expression": {
          "type": "Function",
          "name": "keys",
          "children": [
            {
              "type": "Field",
              "name": "empty_hash"
            }
          ]
        },
        "result": []
      },
      {
        "expression": {
          "type": "Function",
          "name": "join",
          "children": [
            {
              "type": "Literal",
              "value": ", "
            },
            {
              "type": "Field",
              "name": "strings"
            }
          ]
        },
        "result": "a, b, c"
      },
      {
        "expression": {
          "type": "Function",
          "name": "join",
          "children": [
            {
              "type": "Literal",
              "value": ", "
            },
            {
              "type": "Field",
              "name": "strings"
            }
          ]
        },
        "result": "a, b, c"
      },
      {
        "expression": {
          "type": "Function",
          "name": "join",
          "children": [
            {
              "type": "Literal",
              "value": ","
            },
            {
              "type": "Literal",
              "value": [
                "a",
                "b"
              ]
            }
          ]
        },
        "result": "a,b"
      },
      {
        "expression": {
          "type": "Function",
          "name": "join",
          "children": [
            {
              "type": "Literal",
              "value": "|"
            },
            {
              "type": "Field",
              "name": "strings"
            }
          ]
        },
        "result": "a|b|c"
      },
      {
        "expression": {
          "type": "Function",
          "name": "join",
          "children": [
            {
              "type": "Literal",
              "value": "|"
            },
            {
              "type": "Projection",
              "children": [
                {
                  "type": "Flatten",
                  "children": [
                    {
                      "type": "Field",
                      "name": "decimals"
                    }
                  ]
                },
                {
                  "type": "Function",
                  "name": "to_string",
                  "children": [
                    {
                      "type": "Current"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": "1.01|1.2|-1.5"
      },
      {
        "expression": {
          "type": "Function",
          "name": "join",
          "children": [
            {
              "type": "Literal",
              "value": "|"
            },
            {
              "type": "Field",
              "name": "empty_list"
            }
          ]
        },
        "result": ""
      },
      {
        "expression": {
          "type": "Function",
          "name": "reverse",
          "children": [
            {
              "type": "Field",
              "name": "numbers"
            }
          ]
        },
        "result": [
          5,
          4,
          3,
          -1
        ]
      },
      {
        "expression": {
          "type": "Function",
          "name": "reverse",
          "children": [
            {
              "type": "Field",
              "name": "array"
            }
          ]
        },
        "result": [
          "100",
          "a",
          5,
          4,
          3,
          -1
        ]
      },
      {
        "expression": {
          "type": "Function",
          "name": "reverse",
          "children": [
            {
              "type": "Literal",
              "value": []
            }
          ]
        },
        "result": []
      },
      {
        "expression": {
          "type": "Function",
          "name": "reverse",
          "children": [
            {
              "type": "Literal",
              "value": ""
            }
          ]
        },
        "result": ""
      },
      {
        "expression": {
          "type": "Function",
          "name": "reverse",
          "children": [
            {
              "type": "Literal",
              "value": "hello world"
            }
          ]
        },
        "result": "dlrow olleh"
      },
      {
        "expression": {
          "type": "Function",
          "name": "starts_with",
          "children": [
            {
              "type": "Field",
              "name": "str"
            },
            {
              "type": "Literal",
              "value": "S"
            }
          ]
        },
        "result": true
      },
      {
        "expression": {
          "type": "Function",
          "name": "starts_with",
          "children": [
            {
              "type": "Field",
              "name": "str"
            },
            {
              "type": "Literal",
              "value": "St"
            }
          ]
        },
        "result": true
      },
      {
        "expression": {
          "type": "Function",
          "name": "starts_with",
          "children": [
            {
              "type": "Field",
              "name": "str"
            },
            {
              "type": "Literal",
              "value": "Str"
            }
          ]
        },
        "result": true
      },
      {
        "expression": {
          "type": "Function",
          "name": "starts_with",
          "children": [
            {
              "type": "Field",
              "name": "str"
            },
            {
              "type": "Literal",
              "value": "String"
            }
          ]
        },
        "result": false
      },
      {
        "expression": {
          "type": "Function",
          "name": "sum",
          "children": [
            {
              "type": "Field",
              "name": "numbers"
            }
          ]
        },
        "result": 11
      },
      {
        "expression": {
          "type": "Function",
          "name": "sum",
          "children": [
            {
              "type": "Field",
              "name": "decimals"
            }
          ]
        },
        "result": 0.71
      },
      {
        "expression": {
          "type": "Function",
          "name": "sum",
          "children": [
            {
              "type": "Projection",
              "children": [
                {
                  "type": "Flatten",
                  "children": [
                    {
                      "type": "Field",
                      "name": "array"
                    }
                  ]
                },
                {
                  "type": "Function",
                  "name": "to_number",
                  "children": [
                    {
                      "type": "Current"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": 111
      },
      {
        "expression": {
          "type": "Function",
          "name": "sum",
          "children": [
            {
              "type": "Literal",
              "value": []
            }
          ]
        },
        "result": 0
      },
      {
        "expression": {
          "type": "Function",
          "name": "to_array",
          "children": [
            {
              "type": "Literal",
              "value": "foo"
            }
          ]
        },
        "result": [
          "foo"
        ]
      },
      {
        "expression": {
          "type": "Function",
          "name": "to_array",
          "children": [
            {
              "type": "Literal",
              "value": 0
            }
          ]
        },
        "result": [
          0
        ]
      },
      {
        "expression": {
          "type": "Function",
          "name": "to_array",
          "children": [
            {
              "type": "Field",
              "name": "objects"
            }
          ]
        },
        "result": [
          {
            "foo": "bar",
            "bar": "baz"
          }
        ]
      },
      {
        "expression": {
          "type": "Function",
          "name": "to_array",
          "children": [
            {
              "type": "Literal",
              "value": [
                1,
                2,
                3
              ]
            }
          ]
        },
        "result": [
          1,
          2,
          3
        ]
      },
      {
        "expression": {
          "type": "Function",
          "name": "to_array",
          "children": [
            {
              "type": "Field",
              "name": "false"
            }
          ]
        },
        "result": [
          false
        ]
      },
      {
        "expression": {
          "type": "Function",
          "name": "to_string",
          "children": [
            {
              "type": "Literal",
              "value": "foo"
            }
          ]
        },
        "result": "foo"
      },
      {
        "expression": {
          "type": "Function",
          "name": "to_string",
          "children": [
            {
              "type": "Literal",
              "value": 1.2
            }
          ]
        },
        "result": "1.2"
      },
      {
        "expression": {
          "type": "Function",
          "name": "to_string",
          "children": [
            {
              "type": "Literal",
              "value": [
                0,
                1
              ]
            }
          ]
        },
        "result": "[0,1]"
      },
      {
        "expression": {
          "type": "Function",
          "name": "to_number",
          "children": [
            {
              "type": "Literal",
              "value": "1.0"
            }
          ]
        },
        "result": 1
      },
      {
        "expression": {
          "type": "Function",
          "name": "to_number",
          "children": [
            {
              "type": "Literal",
              "value": "1.1"
            }
          ]
        },
        "result": 1.1
      },
      {
        "expression": {
          "type": "Function",
          "name": "to_number",
          "children": [
            {
              "type": "Literal",
              "value": "4"
            }
          ]
        },
        "result": 4
      },
      {
        "expression": {
          "type": "Function",
          "name": "to_number",
          "children": [
            {
              "type": "Literal",
              "value": "notanumber"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Function",
          "name": "to_number",
          "children": [
            {
              "type": "Literal",
              "value": false
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Function",
          "name": "to_number",
          "children": [
            {
              "type": "Literal",
              "value": null
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Function",
          "name": "to_number",
          "children": [
            {
              "type": "Literal",
              "value": [
                0
              ]
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Function",
          "name": "to_number",
          "children": [
            {
              "type": "Literal",
              "value": {
                "foo": 0
              }
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Function",
          "name": "sort",
          "children": [
            {
              "type": "Field",
              "name": "numbers"
            }
          ]
        },
        "result": [
          -1,
          3,
          4,
          5
        ]
      },
      {
        "expression": {
          "type": "Function",
          "name": "sort",
          "children": [
            {
              "type": "Field",
              "name": "strings"
            }
          ]
        },
        "result": [
          "a",
          "b",
          "c"
        ]
      },
      {
        "expression": {
          "type": "Function",
          "name": "sort",
          "children": [
            {
              "type": "Field",
              "name": "decimals"
            }
          ]
        },
        "result": [
          -1.5,
          1.01,
          1.2
        ]
      },
      {
        "expression": {
          "type": "Function",
          "name": "sort",
          "children": [
            {
              "type": "Field",
              "name": "empty_list"
            }
          ]
        },
        "result": []
      },
      {
        "expression": {
          "type": "Function",
          "name": "not_null",
          "children": [
            {
              "type": "Field",
              "name": "unknown_key"
            },
            {
              "type": "Field",
              "name": "str"
            }
          ]
        },
        "result": "Str"
      },
      {
        "expression": {
          "type": "Function",
          "name": "not_null",
          "children": [
            {
              "type": "Field",
              "name": "unknown_key"
            },
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Field",
                  "name": "bar"
                }
              ]
            },
            {
              "type": "Field",
              "name": "empty_list"
            },
            {
              "type": "Field",
              "name": "str"
            }
          ]
        },
        "result": []
      },
      {
        "expression": {
          "type": "Function",
          "name": "not_null",
          "children": [
            {
              "type": "Field",
              "name": "unknown_key"
            },
            {
              "type": "Field",
              "name": "null_key"
            },
            {
              "type": "Field",
              "name": "empty_list"
            },
            {
              "type": "Field",
              "name": "str"
            }
          ]
        },
        "result": []
      },
      {
        "expression": {
          "type": "Function",
          "name": "not_null",
          "children": [
            {
              "type": "Field",
              "name": "all"
            },
            {
              "type": "Field",
              "name": "expressions"
            },
            {
              "type": "Field",
              "name": "are_null"
            }
          ]
        },
        "result": null
      },
      {
        "description": "function projection on single arg function",
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Field",
                  "name": "numbers"
                }
              ]
            },
            {
              "type": "Function",
              "name": "to_string",
              "children": [
                {
                  "type": "Current"
                }
              ]
            }
          ]
        },
        "result": [
          "-1",
          "3",
          "4",
          "5"
        ]
      },
      {
        "description": "function projection on single arg function",
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Field",
                  "name": "array"
                }
              ]
            },
            {
              "type": "Function",
              "name": "to_number",
              "children": [
                {
                  "type": "Current"
                }
              ]
            }
          ]
        },
        "result": [
          -1,
          3,
          4,
          5,
          100
        ]
      }
    ]
  },
  {
    "given": {
      "foo": [
        {
          "b": "b",
          "a": "a"
        },
        {
          "c": "c",
          "b": "b"
        },
        {
          "d": "d",
          "c": "c"
        },
        {
          "e": "e",
          "d": "d"
        },
        {
          "f": "f",
          "e": "e"
        }
      ]
    },
    "cases": [
      {
        "description": "function projection on variadic function",
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                }
              ]
            },
            {
              "type": "Function",
              "name": "not_null",
              "children": [
                {
                  "type": "Field",
                  "name": "f"
                },
                {
                  "type": "Field",
                  "name": "e"
                },
                {
                  "type": "Field",
                  "name": "d"
                },
                {
                  "type": "Field",
                  "name": "c"
                },
                {
                  "type": "Field",
                  "name": "b"
                },
                {
                  "type": "Field",
                  "name": "a"
                }
              ]
            }
          ]
        },
        "result": [
          "b",
          "c",
          "d",
          "e",
          "f"
        ]
      }
    ]
  },
  {
    "given": {
      "people": [
        {
          "age": 20,
          "age_str": "20",
          "bool": true,
          "name": "a",
          "extra": "foo"
        },
        {
          "age": 40,
          "age_str": "40",
          "bool": false,
          "name": "b",
          "extra": "bar"
        },
        {
          "age": 30,
          "age_str": "30",
          "bool": true,
          "name": "c"
        },
        {
          "age": 50,
          "age_str": "50",
          "bool": false,
          "name": "d"
        },
        {
          "age": 10,
          "age_str": "10",
          "bool": true,
          "name": 3
        }
      ]
    },
    "cases": [
      {
        "description": "sort by field expression",
        "expression": {
          "type": "Function",
          "name": "sort_by",
          "children": [
            {
              "type": "Field",
              "name": "people"
            },
            {
              "type": "ExpressionReference",
              "children": [
                {
                  "type": "Field",
                  "name": "age"
                }
              ]
            }
          ]
        },
        "result": [
          {
            "age": 10,
            "age_str": "10",
            "bool": true,
            "name": 3
          },
          {
            "age": 20,
            "age_str": "20",
            "bool": true,
            "name": "a",
            "extra": "foo"
          },
          {
            "age": 30,
            "age_str": "30",
            "bool": true,
            "name": "c"
          },
          {
            "age": 40,
            "age_str": "40",
            "bool": false,
            "name": "b",
            "extra": "bar"
          },
          {
            "age": 50,
            "age_str": "50",
            "bool": false,
            "name": "d"
          }
        ]
      },
      {
        "expression": {
          "type": "Function",
          "name": "sort_by",
          "children": [
            {
              "type": "Field",
              "name": "people"
            },
            {
              "type": "ExpressionReference",
              "children": [
                {
                  "type": "Field",
                  "name": "age_str"
                }
              ]
            }
          ]
        },
        "result": [
          {
            "age": 10,
            "age_str": "10",
            "bool": true,
            "name": 3
          },
          {
            "age": 20,
            "age_str": "20",
            "bool": true,
            "name": "a",
            "extra": "foo"
          },
          {
            "age": 30,
            "age_str": "30",
            "bool": true,
            "name": "c"
          },
          {
            "age": 40,
            "age_str": "40",
            "bool": false,
            "name": "b",
            "extra": "bar"
          },
          {
            "age": 50,
            "age_str": "50",
            "bool": false,
            "name": "d"
          }
        ]
      },
      {
        "description": "sort by function expression",
        "expression": {
          "type": "Function",
          "name": "sort_by",
          "children": [
            {
              "type": "Field",
              "name": "people"
            },
            {
              "type": "ExpressionReference",
              "children": [
                {
                  "type": "Function",
                  "name": "to_number",
                  "children": [
                    {
                      "type": "Field",
                      "name": "age_str"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          {
            "age": 10,
            "age_str": "10",
            "bool": true,
            "name": 3
          },
          {
            "age": 20,
            "age_str": "20",
            "bool": true,
            "name": "a",
            "extra": "foo"
          },
          {
            "age": 30,
            "age_str": "30",
            "bool": true,
            "name": "c"
          },
          {
            "age": 40,
            "age_str": "40",
            "bool": false,
            "name": "b",
            "extra": "bar"
          },
          {
            "age": 50,
            "age_str": "50",
            "bool": false,
            "name": "d"
          }
        ]
      },
      {
        "description": "function projection on sort_by function",
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Function",
                  "name": "sort_by",
                  "children": [
                    {
                      "type": "Field",
                      "name": "people"
                    },
                    {
                      "type": "ExpressionReference",
                      "children": [
                        {
                          "type": "Field",
                          "name": "age"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "Field",
              "name": "name"
            }
          ]
        },
        "result": [
          3,
          "a",
          "c",
          "b",
          "d"
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Function",
                  "name": "sort_by",
                  "children": [
                    {
                      "type": "Field",
                      "name": "people"
                    },
                    {
                      "type": "ExpressionReference",
                      "children": [
                        {
                          "type": "Field",
                          "name": "age"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "Field",
              "name": "extra"
            }
          ]
        },
        "result": [
          "foo",
          "bar"
        ]
      },
      {
        "expression": {
          "type": "Function",
          "name": "sort_by",
          "children": [
            {
              "type": "Literal",
              "value": []
            },
            {
              "type": "ExpressionReference",
              "children": [
                {
                  "type": "Field",
                  "name": "age"
                }
              ]
            }
          ]
        },
        "result": []
      },
      {
        "expression": {
          "type": "Function",
          "name": "max_by",
          "children": [
            {
              "type": "Field",
              "name": "people"
            },
            {
              "type": "ExpressionReference",
              "children": [
                {
                  "type": "Field",
                  "name": "age"
                }
              ]
            }
          ]
        },
        "result": {
          "age": 50,
          "age_str": "50",
          "bool": false,
          "name": "d"
        }
      },
      {
        "expression": {
          "type": "Function",
          "name": "max_by",
          "children": [
            {
              "type": "Field",
              "name": "people"
            },
            {
              "type": "ExpressionReference",
              "children": [
                {
                  "type": "Field",
                  "name": "age_str"
                }
              ]
            }
          ]
        },
        "result": {
          "age": 50,
          "age_str": "50",
          "bool": false,
          "name": "d"
        }
      },
      {
        "expression": {
          "type": "Function",
          "name": "max_by",
          "children": [
            {
              "type": "Field",
              "name": "people"
            },
            {
              "type": "ExpressionReference",
              "children": [
                {
                  "type": "Function",
                  "name": "to_number",
                  "children": [
                    {
                      "type": "Field",
                      "name": "age_str"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": {
          "age": 50,
          "age_str": "50",
          "bool": false,
          "name": "d"
        }
      },
      {
        "expression": {
          "type": "Function",
          "name": "min_by",
          "children": [
            {
              "type": "Field",
              "name": "people"
            },
            {
              "type": "ExpressionReference",
              "children": [
                {
                  "type": "Field",
                  "name": "age"
                }
              ]
            }
          ]
        },
        "result": {
          "age": 10,
          "age_str": "10",
          "bool": true,
          "name": 3
        }
      },
      {
        "expression": {
          "type": "Function",
          "name": "min_by",
          "children": [
            {
              "type": "Field",
              "name": "people"
            },
            {
              "type": "ExpressionReference",
              "children": [
                {
                  "type": "Field",
                  "name": "age_str"
                }
              ]
            }
          ]
        },
        "result": {
          "age": 10,
          "age_str": "10",
          "bool": true,
          "name": 3
        }
      },
      {
        "expression": {
          "type": "Function",
          "name": "min_by",
          "children": [
            {
              "type": "Field",
              "name": "people"
            },
            {
              "type": "ExpressionReference",
              "children": [
                {
                  "type": "Function",
                  "name": "to_number",
                  "children": [
                    {
                      "type": "Field",
                      "name": "age_str"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": {
          "age": 10,
          "age_str": "10",
          "bool": true,
          "name": 3
        }
      }
    ]
  },
  {
    "given": {
      "people": [
        {
          "age": 10,
          "order": "1"
        },
        {
          "age": 10,
          "order": "2"
        },
        {
          "age": 10,
          "order": "3"
        },
        {
          "age": 10,
          "order": "4"
        },
        {
          "age": 10,
          "order": "5"
        },
        {
          "age": 10,
          "order": "6"
        },
        {
          "age": 10,
          "order": "7"
        },
        {
          "age": 10,
          "order": "8"
        },
        {
          "age": 10,
          "order": "9"
        },
        {
          "age": 10,
          "order": "10"
        },
        {
          "age": 10,
          "order": "11"
        }
      ]
    },
    "cases": [
      {
        "description": "stable sort order",
        "expression": {
          "type": "Function",
          "name": "sort_by",
          "children": [
            {
              "type": "Field",
              "name": "people"
            },
            {
              "type": "ExpressionReference",
              "children": [
                {
                  "type": "Field",
                  "name": "age"
                }
              ]
            }
          ]
        },
        "result": [
          {
            "age": 10,
            "order": "1"
          },
          {
            "age": 10,
            "order": "2"
          },
          {
            "age": 10,
            "order": "3"
          },
          {
            "age": 10,
            "order": "4"
          },
          {
            "age": 10,
            "order": "5"
          },
          {
            "age": 10,
            "order": "6"
          },
          {
            "age": 10,
            "order": "7"
          },
          {
            "age": 10,
            "order": "8"
          },
          {
            "age": 10,
            "order": "9"
          },
          {
            "age": 10,
            "order": "10"
          },
          {
            "age": 10,
            "order": "11"
          }
        ]
      }
    ]
  },
  {
    "given": {
      "people": [
        {
          "a": 10,
          "b": 1,
          "c": "z"
        },
        {
          "a": 10,
          "b": 2,
          "c": null
        },
        {
          "a": 10,
          "b": 3
        },
        {
          "a": 10,
          "b": 4,
          "c": "z"
        },
        {
          "a": 10,
          "b": 5,
          "c": null
        },
        {
          "a": 10,
          "b": 6
        },
        {
          "a": 10,
          "b": 7,
          "c": "z"
        },
        {
          "a": 10,
          "b": 8,
          "c": null
        },
        {
          "a": 10,
          "b": 9
        }
      ],
      "empty": []
    },
    "cases": [
      {
        "expression": {
          "type": "Function",
          "name": "map",
          "children": [
            {
              "type": "ExpressionReference",
              "children": [
                {
                  "type": "Field",
                  "name": "a"
                }
              ]
            },
            {
              "type": "Field",
              "name": "people"
            }
          ]
        },
        "result": [
          10,
          10,
          10,
          10,
          10,
          10,
          10,
          10,
          10
        ]
      },
      {
        "expression": {
          "type": "Function",
          "name": "map",
          "children": [
            {
              "type": "ExpressionReference",
              "children": [
                {
                  "type": "Field",
                  "name": "c"
                }
              ]
            },
            {
              "type": "Field",
              "name": "people"
            }
          ]
        },
        "result": [
          "z",
          null,
          null,
          "z",
          null,
          null,
          "z",
          null,
          null
        ]
      },
      {
        "expression": {
          "type": "Function",
          "name": "map",
          "children": [
            {
              "type": "ExpressionReference",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                }
              ]
            },
            {
              "type": "Field",
              "name": "empty"
            }
          ]
        },
        "result": []
      }
    ]
  },
  {
    "given": {
      "array": [
        {
          "foo": {
            "bar": "yes1"
          }
        },
        {
          "foo": {
            "bar": "yes2"
          }
        },
        {
          "foo1": {
            "bar": "no"
          }
        }
      ]
    },
    "cases": [
      {
        "expression": {
          "type": "Function",
          "name": "map",
          "children": [
            {
              "type": "ExpressionReference",
              "children": [
                {
                  "type": "Subexpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "foo"
                    },
                    {
                      "type": "Field",
                      "name": "bar"
                    }
                  ]
                }
              ]
            },
            {
              "type": "Field",
              "name": "array"
            }
          ]
        },
        "result": [
          "yes1",
          "yes2",
          null
        ]
      },
      {
        "expression": {
          "type": "Function",
          "name": "map",
          "children": [
            {
              "type": "ExpressionReference",
              "children": [
                {
                  "type": "Subexpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "foo1"
                    },
                    {
                      "type": "Field",
                      "name": "bar"
                    }
                  ]
                }
              ]
            },
            {
              "type": "Field",
              "name": "array"
            }
          ]
        },
        "result": [
          null,
          null,
          "no"
        ]
      },
      {
        "expression": {
          "type": "Function",
          "name": "map",
          "children": [
            {
              "type": "ExpressionReference",
              "children": [
                {
                  "type": "Subexpression",
                  "children": [
                    {
                      "type": "Subexpression",
                      "children": [
                        {
                          "type": "Field",
                          "name": "foo"
                        },
                        {
                          "type": "Field",
                          "name": "bar"
                        }
                      ]
                    },
                    {
                      "type": "Field",
                      "name": "baz"
                    }
                  ]
                }
              ]
            },
            {
              "type": "Field",
              "name": "array"
            }
          ]
        },
        "result": [
          null,
          null,
          null
        ]
      }
    ]
  },
  {
    "given": {
      "array": [
        [
          1,
          2,
          3,
          [
            4
          ]
        ],
        [
          5,
          6,
          7,
          [
            8,
            9
          ]
        ]
      ]
    },
    "cases": [
      {
        "expression": {
          "type": "Function",
          "name": "map",
          "children": [
            {
              "type": "ExpressionReference",
              "children": [
                {
                  "type": "Projection",
                  "children": [
                    {
                      "type": "Flatten",
                      "children": [
                        {
                          "type": "Identity"
                        }
                      ]
                    },
                    {
                      "type": "Identity"
                    }
                  ]
                }
              ]
            },
            {
              "type": "Field",
              "name": "array"
            }
          ]
        },
        "result": [
          [
            1,
            2,
            3,
            4
          ],
          [
            5,
            6,
            7,
            8,
            9
          ]
        ]
      }
    ]
  },
  {
    "given": {
      "__L": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "__L"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "!\r": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "!\r"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "Y_1623": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "Y_1623"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "x": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "x"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "\tF캻": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "\tF캻"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      " \t": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": " \t"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      " ": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": " "
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "v2": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "v2"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "\t": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "\t"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "_X": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "_X"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "\t4򆤕": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "\t4򆤕"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "v24_W": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "v24_W"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "H": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "H"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "\f": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "\f"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "E4": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "E4"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "!": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "!"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "tM": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "tM"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      " [": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": " ["
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "R!": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "R!"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "_6W": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "_6W"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "ꮡ\r": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "ꮡ\r"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "tL7": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "tL7"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "<<U\t": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "<<U\t"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "믎﫻": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "믎﫻"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "sNA_": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "sNA_"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "9": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "9"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "\\\b񂲃": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "\\\b񂲃"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "r": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "r"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "Q": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "Q"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "_Q__7GL8": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "_Q__7GL8"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "\\": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "\\"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "RR9_": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "RR9_"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "\r\f:": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "\r\f:"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "r7": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "r7"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "-": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "-"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "p9": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "p9"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "__": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "__"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "\b\t": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "\b\t"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "O_": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "O_"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "_r_8": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "_r_8"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "_j": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "_j"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      ":": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": ":"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "\rB": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "\rB"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "Obf": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "Obf"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "\n": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "\n"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "\f󥌳": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "\f󥌳"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "\\俜": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "\\俜"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "\r": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "\r"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "m_": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "m_"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "\r\fB ": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "\r\fB "
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "+\"\"": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "+\"\""
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "Mg": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "Mg"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "\"!/": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "\"!/"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "7\"": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "7\""
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "\\󞢤S": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "\\󞢤S"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "\"": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "\""
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "Kl": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "Kl"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "\b\b": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "\b\b"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      ">": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": ">"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "hvu": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "hvu"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "; !": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "; !"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "hU": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "hU"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "!I\n/": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "!I\n/"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": ""
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "U)\t": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "U)\t"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "fa0_9": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "fa0_9"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "/": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "/"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "Gy": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "Gy"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "\b": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "\b"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "<": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "<"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "\t": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "\t"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "\t&\\\r": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "\t&\\\r"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "#": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "#"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "B__": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "B__"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "\nS \n": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "\nS \n"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "Bp": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "Bp"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      ",\t;": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": ",\t;"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "B_q": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "B_q"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "/+\t\n\b!Z": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "/+\t\n\b!Z"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "󇟇\\ueFAc": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "󇟇\\ueFAc"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      ":\f": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": ":\f"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "/": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "/"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "_BW_6Hg_Gl": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "_BW_6Hg_Gl"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "􃰂": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "􃰂"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "zs1DC": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "zs1DC"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "__434": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "__434"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "󵅁": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "󵅁"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "Z_5": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "Z_5"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "z_M_": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "z_M_"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "YU_2": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "YU_2"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "_0": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "_0"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "\b+": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "\b+"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "\"": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "\""
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "D7": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "D7"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "_62L": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "_62L"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "\tK\t": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "\tK\t"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "\n\\\f": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "\n\\\f"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "I_": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "I_"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "W_a0_": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "W_a0_"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "BQ": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "BQ"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "\tX$ꮻ": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "\tX$ꮻ"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "Z9": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "Z9"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "\b%\"򞄏": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "\b%\"򞄏"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "_F": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "_F"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "!,": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "!,"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "\"!": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "\"!"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "Hh": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "Hh"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "&": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "&"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "9\r\\R": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "9\r\\R"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "M_k": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "M_k"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "!\b\n󑩒\"\"": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "!\b\n󑩒\"\""
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "6": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "6"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "_7": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "_7"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "0": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "0"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "\\8\\": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "\\8\\"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "b7eo": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "b7eo"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "xIUo9": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "xIUo9"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "5": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "5"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "?": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "?"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "sU": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "sU"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "VH2&H\\/": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "VH2&H\\/"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "_C": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "_C"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "_": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "_"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "<\t": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "<\t"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "𝄞": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "𝄞"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "foo": {
        "bar": [
          "zero",
          "one",
          "two"
        ]
      }
    },
    "cases": [
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": "zero"
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Index",
                  "value": 1
                }
              ]
            }
          ]
        },
        "result": "one"
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Index",
                  "value": 2
                }
              ]
            }
          ]
        },
        "result": "two"
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Index",
                  "value": 3
                }
              ]
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Index",
                  "value": -1
                }
              ]
            }
          ]
        },
        "result": "two"
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Index",
                  "value": -2
                }
              ]
            }
          ]
        },
        "result": "one"
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Index",
                  "value": -3
                }
              ]
            }
          ]
        },
        "result": "zero"
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Index",
                  "value": -4
                }
              ]
            }
          ]
        },
        "result": null
      }
    ]
  },
  {
    "given": {
      "foo": [
        {
          "bar": "one"
        },
        {
          "bar": "two"
        },
        {
          "bar": "three"
        },
        {
          "notbar": "four"
        }
      ]
    },
    "cases": [
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Field",
              "name": "bar"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            },
            {
              "type": "Field",
              "name": "bar"
            }
          ]
        },
        "result": "one"
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Index",
                  "value": 1
                }
              ]
            },
            {
              "type": "Field",
              "name": "bar"
            }
          ]
        },
        "result": "two"
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Index",
                  "value": 2
                }
              ]
            },
            {
              "type": "Field",
              "name": "bar"
            }
          ]
        },
        "result": "three"
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Index",
                  "value": 3
                }
              ]
            },
            {
              "type": "Field",
              "name": "notbar"
            }
          ]
        },
        "result": "four"
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Index",
                  "value": 3
                }
              ]
            },
            {
              "type": "Field",
              "name": "bar"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "IndexExpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Index",
              "value": 0
            }
          ]
        },
        "result": {
          "bar": "one"
        }
      },
      {
        "expression": {
          "type": "IndexExpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Index",
              "value": 1
            }
          ]
        },
        "result": {
          "bar": "two"
        }
      },
      {
        "expression": {
          "type": "IndexExpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Index",
              "value": 2
            }
          ]
        },
        "result": {
          "bar": "three"
        }
      },
      {
        "expression": {
          "type": "IndexExpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Index",
              "value": 3
            }
          ]
        },
        "result": {
          "notbar": "four"
        }
      },
      {
        "expression": {
          "type": "IndexExpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Index",
              "value": 4
            }
          ]
        },
        "result": null
      }
    ]
  },
  {
    "given": [
      "one",
      "two",
      "three"
    ],
    "cases": [
      {
        "expression": {
          "type": "IndexExpression",
          "children": [
            {
              "type": "Identity"
            },
            {
              "type": "Index",
              "value": 0
            }
          ]
        },
        "result": "one"
      },
      {
        "expression": {
          "type": "IndexExpression",
          "children": [
            {
              "type": "Identity"
            },
            {
              "type": "Index",
              "value": 1
            }
          ]
        },
        "result": "two"
      },
      {
        "expression": {
          "type": "IndexExpression",
          "children": [
            {
              "type": "Identity"
            },
            {
              "type": "Index",
              "value": 2
            }
          ]
        },
        "result": "three"
      },
      {
        "expression": {
          "type": "IndexExpression",
          "children": [
            {
              "type": "Identity"
            },
            {
              "type": "Index",
              "value": -1
            }
          ]
        },
        "result": "three"
      },
      {
        "expression": {
          "type": "IndexExpression",
          "children": [
            {
              "type": "Identity"
            },
            {
              "type": "Index",
              "value": -2
            }
          ]
        },
        "result": "two"
      },
      {
        "expression": {
          "type": "IndexExpression",
          "children": [
            {
              "type": "Identity"
            },
            {
              "type": "Index",
              "value": -3
            }
          ]
        },
        "result": "one"
      }
    ]
  },
  {
    "given": {
      "reservations": [
        {
          "instances": [
            {
              "foo": 1
            },
            {
              "foo": 2
            }
          ]
        }
      ]
    },
    "cases": [
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Projection",
                  "children": [
                    {
                      "type": "Flatten",
                      "children": [
                        {
                          "type": "Field",
                          "name": "reservations"
                        }
                      ]
                    },
                    {
                      "type": "Field",
                      "name": "instances"
                    }
                  ]
                }
              ]
            },
            {
              "type": "Field",
              "name": "foo"
            }
          ]
        },
        "result": [
          1,
          2
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Projection",
                  "children": [
                    {
                      "type": "Flatten",
                      "children": [
                        {
                          "type": "Field",
                          "name": "reservations"
                        }
                      ]
                    },
                    {
                      "type": "Field",
                      "name": "instances"
                    }
                  ]
                }
              ]
            },
            {
              "type": "Field",
              "name": "bar"
            }
          ]
        },
        "result": []
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Projection",
                  "children": [
                    {
                      "type": "Flatten",
                      "children": [
                        {
                          "type": "Field",
                          "name": "reservations"
                        }
                      ]
                    },
                    {
                      "type": "Field",
                      "name": "notinstances"
                    }
                  ]
                }
              ]
            },
            {
              "type": "Field",
              "name": "foo"
            }
          ]
        },
        "result": []
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Projection",
                  "children": [
                    {
                      "type": "Flatten",
                      "children": [
                        {
                          "type": "Field",
                          "name": "reservations"
                        }
                      ]
                    },
                    {
                      "type": "Field",
                      "name": "notinstances"
                    }
                  ]
                }
              ]
            },
            {
              "type": "Field",
              "name": "foo"
            }
          ]
        },
        "result": []
      }
    ]
  },
  {
    "given": {
      "reservations": [
        {
          "instances": [
            {
              "foo": [
                {
                  "bar": 1
                },
                {
                  "bar": 2
                },
                {
                  "notbar": 3
                },
                {
                  "bar": 4
                }
              ]
            },
            {
              "foo": [
                {
                  "bar": 5
                },
                {
                  "bar": 6
                },
                {
                  "notbar": [
                    7
                  ]
                },
                {
                  "bar": 8
                }
              ]
            },
            {
              "foo": "bar"
            },
            {
              "notfoo": [
                {
                  "bar": 20
                },
                {
                  "bar": 21
                },
                {
                  "notbar": [
                    7
                  ]
                },
                {
                  "bar": 22
                }
              ]
            },
            {
              "bar": [
                {
                  "baz": [
                    1
                  ]
                },
                {
                  "baz": [
                    2
                  ]
                },
                {
                  "baz": [
                    3
                  ]
                },
                {
                  "baz": [
                    4
                  ]
                }
              ]
            },
            {
              "baz": [
                {
                  "baz": [
                    1,
                    2
                  ]
                },
                {
                  "baz": []
                },
                {
                  "baz": []
                },
                {
                  "baz": [
                    3,
                    4
                  ]
                }
              ]
            },
            {
              "qux": [
                {
                  "baz": []
                },
                {
                  "baz": [
                    1,
                    2,
                    3
                  ]
                },
                {
                  "baz": [
                    4
                  ]
                },
                {
                  "baz": []
                }
              ]
            }
          ],
          "otherkey": {
            "foo": [
              {
                "bar": 1
              },
              {
                "bar": 2
              },
              {
                "notbar": 3
              },
              {
                "bar": 4
              }
            ]
          }
        },
        {
          "instances": [
            {
              "a": [
                {
                  "bar": 1
                },
                {
                  "bar": 2
                },
                {
                  "notbar": 3
                },
                {
                  "bar": 4
                }
              ]
            },
            {
              "b": [
                {
                  "bar": 5
                },
                {
                  "bar": 6
                },
                {
                  "notbar": [
                    7
                  ]
                },
                {
                  "bar": 8
                }
              ]
            },
            {
              "c": "bar"
            },
            {
              "notfoo": [
                {
                  "bar": 23
                },
                {
                  "bar": 24
                },
                {
                  "notbar": [
                    7
                  ]
                },
                {
                  "bar": 25
                }
              ]
            },
            {
              "qux": [
                {
                  "baz": []
                },
                {
                  "baz": [
                    1,
                    2,
                    3
                  ]
                },
                {
                  "baz": [
                    4
                  ]
                },
                {
                  "baz": []
                }
              ]
            }
          ],
          "otherkey": {
            "foo": [
              {
                "bar": 1
              },
              {
                "bar": 2
              },
              {
                "notbar": 3
              },
              {
                "bar": 4
              }
            ]
          }
        }
      ]
    },
    "cases": [
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Projection",
                  "children": [
                    {
                      "type": "Flatten",
                      "children": [
                        {
                          "type": "Projection",
                          "children": [
                            {
                              "type": "Flatten",
                              "children": [
                                {
                                  "type": "Field",
                                  "name": "reservations"
                                }
                              ]
                            },
                            {
                              "type": "Field",
                              "name": "instances"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "Field",
                      "name": "foo"
                    }
                  ]
                }
              ]
            },
            {
              "type": "Field",
              "name": "bar"
            }
          ]
        },
        "result": [
          1,
          2,
          4,
          5,
          6,
          8
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Projection",
                  "children": [
                    {
                      "type": "Flatten",
                      "children": [
                        {
                          "type": "Projection",
                          "children": [
                            {
                              "type": "Flatten",
                              "children": [
                                {
                                  "type": "Field",
                                  "name": "reservations"
                                }
                              ]
                            },
                            {
                              "type": "Field",
                              "name": "instances"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "Field",
                      "name": "foo"
                    }
                  ]
                }
              ]
            },
            {
              "type": "Field",
              "name": "baz"
            }
          ]
        },
        "result": []
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Projection",
                  "children": [
                    {
                      "type": "Flatten",
                      "children": [
                        {
                          "type": "Projection",
                          "children": [
                            {
                              "type": "Flatten",
                              "children": [
                                {
                                  "type": "Field",
                                  "name": "reservations"
                                }
                              ]
                            },
                            {
                              "type": "Field",
                              "name": "instances"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "Field",
                      "name": "notfoo"
                    }
                  ]
                }
              ]
            },
            {
              "type": "Field",
              "name": "bar"
            }
          ]
        },
        "result": [
          20,
          21,
          22,
          23,
          24,
          25
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Projection",
                  "children": [
                    {
                      "type": "Flatten",
                      "children": [
                        {
                          "type": "Projection",
                          "children": [
                            {
                              "type": "Flatten",
                              "children": [
                                {
                                  "type": "Field",
                                  "name": "reservations"
                                }
                              ]
                            },
                            {
                              "type": "Field",
                              "name": "instances"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "Field",
                      "name": "notfoo"
                    }
                  ]
                }
              ]
            },
            {
              "type": "Field",
              "name": "notbar"
            }
          ]
        },
        "result": [
          [
            7
          ],
          [
            7
          ]
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Projection",
                  "children": [
                    {
                      "type": "Flatten",
                      "children": [
                        {
                          "type": "Field",
                          "name": "reservations"
                        }
                      ]
                    },
                    {
                      "type": "Field",
                      "name": "notinstances"
                    }
                  ]
                }
              ]
            },
            {
              "type": "Field",
              "name": "foo"
            }
          ]
        },
        "result": []
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Projection",
                  "children": [
                    {
                      "type": "Flatten",
                      "children": [
                        {
                          "type": "Projection",
                          "children": [
                            {
                              "type": "Flatten",
                              "children": [
                                {
                                  "type": "Field",
                                  "name": "reservations"
                                }
                              ]
                            },
                            {
                              "type": "Field",
                              "name": "instances"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "Field",
                      "name": "foo"
                    }
                  ]
                }
              ]
            },
            {
              "type": "Field",
              "name": "notbar"
            }
          ]
        },
        "result": [
          3,
          [
            7
          ]
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Projection",
                  "children": [
                    {
                      "type": "Flatten",
                      "children": [
                        {
                          "type": "Projection",
                          "children": [
                            {
                              "type": "Flatten",
                              "children": [
                                {
                                  "type": "Field",
                                  "name": "reservations"
                                }
                              ]
                            },
                            {
                              "type": "Field",
                              "name": "instances"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "Field",
                      "name": "bar"
                    }
                  ]
                }
              ]
            },
            {
              "type": "Field",
              "name": "baz"
            }
          ]
        },
        "result": [
          [
            1
          ],
          [
            2
          ],
          [
            3
          ],
          [
            4
          ]
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Projection",
                  "children": [
                    {
                      "type": "Flatten",
                      "children": [
                        {
                          "type": "Projection",
                          "children": [
                            {
                              "type": "Flatten",
                              "children": [
                                {
                                  "type": "Field",
                                  "name": "reservations"
                                }
                              ]
                            },
                            {
                              "type": "Field",
                              "name": "instances"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "Field",
                      "name": "baz"
                    }
                  ]
                }
              ]
            },
            {
              "type": "Field",
              "name": "baz"
            }
          ]
        },
        "result": [
          [
            1,
            2
          ],
          [],
          [],
          [
            3,
            4
          ]
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Projection",
                  "children": [
                    {
                      "type": "Flatten",
                      "children": [
                        {
                          "type": "Projection",
                          "children": [
                            {
                              "type": "Flatten",
                              "children": [
                                {
                                  "type": "Field",
                                  "name": "reservations"
                                }
                              ]
                            },
                            {
                              "type": "Field",
                              "name": "instances"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "Field",
                      "name": "qux"
                    }
                  ]
                }
              ]
            },
            {
              "type": "Field",
              "name": "baz"
            }
          ]
        },
        "result": [
          [],
          [
            1,
            2,
            3
          ],
          [
            4
          ],
          [],
          [],
          [
            1,
            2,
            3
          ],
          [
            4
          ],
          []
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Projection",
                  "children": [
                    {
                      "type": "Flatten",
                      "children": [
                        {
                          "type": "Projection",
                          "children": [
                            {
                              "type": "Flatten",
                              "children": [
                                {
                                  "type": "Projection",
                                  "children": [
                                    {
                                      "type": "Flatten",
                                      "children": [
                                        {
                                          "type": "Field",
                                          "name": "reservations"
                                        }
                                      ]
                                    },
                                    {
                                      "type": "Field",
                                      "name": "instances"
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "Field",
                              "name": "qux"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "Field",
                      "name": "baz"
                    }
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          1,
          2,
          3,
          4,
          1,
          2,
          3,
          4
        ]
      }
    ]
  },
  {
    "given": {
      "foo": [
        [
          [
            "one",
            "two"
          ],
          [
            "three",
            "four"
          ]
        ],
        [
          [
            "five",
            "six"
          ],
          [
            "seven",
            "eight"
          ]
        ],
        [
          [
            "nine"
          ],
          [
            "ten"
          ]
        ]
      ]
    },
    "cases": [
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          [
            "one",
            "two"
          ],
          [
            "three",
            "four"
          ],
          [
            "five",
            "six"
          ],
          [
            "seven",
            "eight"
          ],
          [
            "nine"
          ],
          [
            "ten"
          ]
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                }
              ]
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": [
          "one",
          "three",
          "five",
          "seven",
          "nine",
          "ten"
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                }
              ]
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Index",
                  "value": 1
                }
              ]
            }
          ]
        },
        "result": [
          "two",
          "four",
          "six",
          "eight"
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                }
              ]
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "IndexExpression",
                  "children": [
                    {
                      "type": "Identity"
                    },
                    {
                      "type": "Index",
                      "value": 0
                    }
                  ]
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": []
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                }
              ]
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "IndexExpression",
                  "children": [
                    {
                      "type": "Identity"
                    },
                    {
                      "type": "Index",
                      "value": 2
                    }
                  ]
                },
                {
                  "type": "Index",
                  "value": 2
                }
              ]
            }
          ]
        },
        "result": []
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                }
              ]
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "IndexExpression",
                  "children": [
                    {
                      "type": "IndexExpression",
                      "children": [
                        {
                          "type": "Identity"
                        },
                        {
                          "type": "Index",
                          "value": 0
                        }
                      ]
                    },
                    {
                      "type": "Index",
                      "value": 0
                    }
                  ]
                },
                {
                  "type": "Index",
                  "value": 100
                }
              ]
            }
          ]
        },
        "result": []
      }
    ]
  },
  {
    "given": {
      "foo": [
        {
          "bar": [
            {
              "qux": 2,
              "baz": 1
            },
            {
              "qux": 4,
              "baz": 3
            }
          ]
        },
        {
          "bar": [
            {
              "qux": 6,
              "baz": 5
            },
            {
              "qux": 8,
              "baz": 7
            }
          ]
        }
      ]
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "foo"
        },
        "result": [
          {
            "bar": [
              {
                "qux": 2,
                "baz": 1
              },
              {
                "qux": 4,
                "baz": 3
              }
            ]
          },
          {
            "bar": [
              {
                "qux": 6,
                "baz": 5
              },
              {
                "qux": 8,
                "baz": 7
              }
            ]
          }
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          {
            "bar": [
              {
                "qux": 2,
                "baz": 1
              },
              {
                "qux": 4,
                "baz": 3
              }
            ]
          },
          {
            "bar": [
              {
                "qux": 6,
                "baz": 5
              },
              {
                "qux": 8,
                "baz": 7
              }
            ]
          }
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                }
              ]
            },
            {
              "type": "Field",
              "name": "bar"
            }
          ]
        },
        "result": [
          [
            {
              "qux": 2,
              "baz": 1
            },
            {
              "qux": 4,
              "baz": 3
            }
          ],
          [
            {
              "qux": 6,
              "baz": 5
            },
            {
              "qux": 8,
              "baz": 7
            }
          ]
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Projection",
                  "children": [
                    {
                      "type": "Flatten",
                      "children": [
                        {
                          "type": "Field",
                          "name": "foo"
                        }
                      ]
                    },
                    {
                      "type": "Field",
                      "name": "bar"
                    }
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          {
            "qux": 2,
            "baz": 1
          },
          {
            "qux": 4,
            "baz": 3
          },
          {
            "qux": 6,
            "baz": 5
          },
          {
            "qux": 8,
            "baz": 7
          }
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Projection",
                  "children": [
                    {
                      "type": "Flatten",
                      "children": [
                        {
                          "type": "Field",
                          "name": "foo"
                        }
                      ]
                    },
                    {
                      "type": "Field",
                      "name": "bar"
                    }
                  ]
                }
              ]
            },
            {
              "type": "Field",
              "name": "baz"
            }
          ]
        },
        "result": [
          1,
          3,
          5,
          7
        ]
      }
    ]
  },
  {
    "given": {
      "string": "string",
      "hash": {
        "foo": "bar",
        "bar": "baz"
      },
      "number": 23,
      "nullvalue": null
    },
    "cases": [
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Field",
                  "name": "string"
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Field",
                  "name": "hash"
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Field",
                  "name": "number"
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Field",
                  "name": "nullvalue"
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Field",
                  "name": "string"
                }
              ]
            },
            {
              "type": "Field",
              "name": "foo"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Field",
                  "name": "hash"
                }
              ]
            },
            {
              "type": "Field",
              "name": "foo"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Field",
                  "name": "number"
                }
              ]
            },
            {
              "type": "Field",
              "name": "foo"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Field",
                  "name": "nullvalue"
                }
              ]
            },
            {
              "type": "Field",
              "name": "foo"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Projection",
                  "children": [
                    {
                      "type": "Flatten",
                      "children": [
                        {
                          "type": "Field",
                          "name": "nullvalue"
                        }
                      ]
                    },
                    {
                      "type": "Field",
                      "name": "foo"
                    }
                  ]
                }
              ]
            },
            {
              "type": "Field",
              "name": "bar"
            }
          ]
        },
        "result": null
      }
    ]
  },
  {
    "given": {
      "foo": [
        {
          "name": "a"
        },
        {
          "name": "b"
        }
      ],
      "bar": {
        "baz": "qux"
      }
    },
    "cases": [
      {
        "expression": {
          "type": "Literal",
          "value": "foo"
        },
        "result": "foo"
      },
      {
        "comment": "Interpret escaped unicode.",
        "expression": {
          "type": "Literal",
          "value": "Φ"
        },
        "result": "Φ"
      },
      {
        "expression": {
          "type": "Literal",
          "value": "✓"
        },
        "result": "✓"
      },
      {
        "expression": {
          "type": "Literal",
          "value": [
            1,
            2,
            3
          ]
        },
        "result": [
          1,
          2,
          3
        ]
      },
      {
        "expression": {
          "type": "Literal",
          "value": {
            "a": "b"
          }
        },
        "result": {
          "a": "b"
        }
      },
      {
        "expression": {
          "type": "Literal",
          "value": true
        },
        "result": true
      },
      {
        "expression": {
          "type": "Literal",
          "value": false
        },
        "result": false
      },
      {
        "expression": {
          "type": "Literal",
          "value": null
        },
        "result": null
      },
      {
        "expression": {
          "type": "Literal",
          "value": 0
        },
        "result": 0
      },
      {
        "expression": {
          "type": "Literal",
          "value": 1
        },
        "result": 1
      },
      {
        "expression": {
          "type": "Literal",
          "value": 2
        },
        "result": 2
      },
      {
        "expression": {
          "type": "Literal",
          "value": 3
        },
        "result": 3
      },
      {
        "expression": {
          "type": "Literal",
          "value": 4
        },
        "result": 4
      },
      {
        "expression": {
          "type": "Literal",
          "value": 5
        },
        "result": 5
      },
      {
        "expression": {
          "type": "Literal",
          "value": 6
        },
        "result": 6
      },
      {
        "expression": {
          "type": "Literal",
          "value": 7
        },
        "result": 7
      },
      {
        "expression": {
          "type": "Literal",
          "value": 8
        },
        "result": 8
      },
      {
        "expression": {
          "type": "Literal",
          "value": 9
        },
        "result": 9
      },
      {
        "comment": "Escaping a backtick in quotes",
        "expression": {
          "type": "Literal",
          "value": "foo`bar"
        },
        "result": "foo`bar"
      },
      {
        "comment": "Double quote in literal",
        "expression": {
          "type": "Literal",
          "value": "foo\"bar"
        },
        "result": "foo\"bar"
      },
      {
        "expression": {
          "type": "Literal",
          "value": "1`"
        },
        "result": "1`"
      },
      {
        "comment": "Multiple literal expressions with escapes",
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Literal",
              "value": "\\"
            },
            {
              "type": "MultiSelectHash",
              "children": [
                {
                  "type": "KeyValuePair",
                  "name": "a",
                  "value": {
                    "type": "Literal",
                    "value": "b"
                  }
                }
              ]
            }
          ]
        },
        "result": {
          "a": "b"
        }
      },
      {
        "comment": "literal . identifier",
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Literal",
              "value": {
                "a": "b"
              }
            },
            {
              "type": "Field",
              "name": "a"
            }
          ]
        },
        "result": "b"
      },
      {
        "comment": "literal . identifier . identifier",
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Literal",
                  "value": {
                    "a": {
                      "b": "c"
                    }
                  }
                },
                {
                  "type": "Field",
                  "name": "a"
                }
              ]
            },
            {
              "type": "Field",
              "name": "b"
            }
          ]
        },
        "result": "c"
      },
      {
        "comment": "literal . identifier bracket-expr",
        "expression": {
          "type": "IndexExpression",
          "children": [
            {
              "type": "Literal",
              "value": [
                0,
                1,
                2
              ]
            },
            {
              "type": "Index",
              "value": 1
            }
          ]
        },
        "result": 1
      }
    ]
  },
  {
    "comment": "Literals",
    "given": {
      "type": "object"
    },
    "cases": [
      {
        "comment": "Literal with leading whitespace",
        "expression": {
          "type": "Literal",
          "value": {
            "foo": true
          }
        },
        "result": {
          "foo": true
        }
      },
      {
        "comment": "Literal with trailing whitespace",
        "expression": {
          "type": "Literal",
          "value": {
            "foo": true
          }
        },
        "result": {
          "foo": true
        }
      }
    ]
  },
  {
    "comment": "Raw String Literals",
    "given": {},
    "cases": [
      {
        "expression": {
          "type": "Literal",
          "value": "foo"
        },
        "result": "foo"
      },
      {
        "expression": {
          "type": "Literal",
          "value": "  foo  "
        },
        "result": "  foo  "
      },
      {
        "expression": {
          "type": "Literal",
          "value": "0"
        },
        "result": "0"
      },
      {
        "expression": {
          "type": "Literal",
          "value": "newline\n"
        },
        "result": "newline\n"
      },
      {
        "expression": {
          "type": "Literal",
          "value": "\n"
        },
        "result": "\n"
      },
      {
        "expression": {
          "type": "Literal",
          "value": "✓"
        },
        "result": "✓"
      },
      {
        "expression": {
          "type": "Literal",
          "value": "𝄞"
        },
        "result": "𝄞"
      },
      {
        "expression": {
          "type": "Literal",
          "value": "  [foo]  "
        },
        "result": "  [foo]  "
      },
      {
        "expression": {
          "type": "Literal",
          "value": "[foo]"
        },
        "result": "[foo]"
      },
      {
        "comment": "Do not interpret escaped unicode.",
        "expression": {
          "type": "Literal",
          "value": "\\u03a6"
        },
        "result": "\\u03a6"
      },
      {
        "comment": "Can escape the single quote",
        "expression": {
          "type": "Literal",
          "value": "foo'bar"
        },
        "result": "foo'bar"
      }
    ]
  },
  {
    "given": {
      "foo": {
        "bar": "bar",
        "baz": "baz",
        "qux": "qux",
        "nested": {
          "one": {
            "a": "first",
            "b": "second",
            "c": "third"
          },
          "two": {
            "a": "first",
            "b": "second",
            "c": "third"
          },
          "three": {
            "a": "first",
            "b": "second",
            "c": {
              "inner": "third"
            }
          }
        }
      },
      "bar": 1,
      "baz": 2,
      "qux\"": 3
    },
    "cases": [
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectHash",
              "children": [
                {
                  "type": "KeyValuePair",
                  "name": "bar",
                  "value": {
                    "type": "Field",
                    "name": "bar"
                  }
                }
              ]
            }
          ]
        },
        "result": {
          "bar": "bar"
        }
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectHash",
              "children": [
                {
                  "type": "KeyValuePair",
                  "name": "bar",
                  "value": {
                    "type": "Field",
                    "name": "bar"
                  }
                }
              ]
            }
          ]
        },
        "result": {
          "bar": "bar"
        }
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectHash",
              "children": [
                {
                  "type": "KeyValuePair",
                  "name": "foo.bar",
                  "value": {
                    "type": "Field",
                    "name": "bar"
                  }
                }
              ]
            }
          ]
        },
        "result": {
          "foo.bar": "bar"
        }
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectHash",
              "children": [
                {
                  "type": "KeyValuePair",
                  "name": "bar",
                  "value": {
                    "type": "Field",
                    "name": "bar"
                  }
                },
                {
                  "type": "KeyValuePair",
                  "name": "baz",
                  "value": {
                    "type": "Field",
                    "name": "baz"
                  }
                }
              ]
            }
          ]
        },
        "result": {
          "bar": "bar",
          "baz": "baz"
        }
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectHash",
              "children": [
                {
                  "type": "KeyValuePair",
                  "name": "bar",
                  "value": {
                    "type": "Field",
                    "name": "bar"
                  }
                },
                {
                  "type": "KeyValuePair",
                  "name": "baz",
                  "value": {
                    "type": "Field",
                    "name": "baz"
                  }
                }
              ]
            }
          ]
        },
        "result": {
          "bar": "bar",
          "baz": "baz"
        }
      },
      {
        "expression": {
          "type": "MultiSelectHash",
          "children": [
            {
              "type": "KeyValuePair",
              "name": "baz",
              "value": {
                "type": "Field",
                "name": "baz"
              }
            },
            {
              "type": "KeyValuePair",
              "name": "qux\"",
              "value": {
                "type": "Field",
                "name": "qux\""
              }
            }
          ]
        },
        "result": {
          "baz": 2,
          "qux\"": 3
        }
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectHash",
              "children": [
                {
                  "type": "KeyValuePair",
                  "name": "bar",
                  "value": {
                    "type": "Field",
                    "name": "bar"
                  }
                },
                {
                  "type": "KeyValuePair",
                  "name": "baz",
                  "value": {
                    "type": "Field",
                    "name": "baz"
                  }
                }
              ]
            }
          ]
        },
        "result": {
          "bar": "bar",
          "baz": "baz"
        }
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectHash",
              "children": [
                {
                  "type": "KeyValuePair",
                  "name": "bar",
                  "value": {
                    "type": "Field",
                    "name": "bar"
                  }
                },
                {
                  "type": "KeyValuePair",
                  "name": "qux",
                  "value": {
                    "type": "Field",
                    "name": "qux"
                  }
                }
              ]
            }
          ]
        },
        "result": {
          "bar": "bar",
          "qux": "qux"
        }
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectHash",
              "children": [
                {
                  "type": "KeyValuePair",
                  "name": "bar",
                  "value": {
                    "type": "Field",
                    "name": "bar"
                  }
                },
                {
                  "type": "KeyValuePair",
                  "name": "noexist",
                  "value": {
                    "type": "Field",
                    "name": "noexist"
                  }
                }
              ]
            }
          ]
        },
        "result": {
          "bar": "bar",
          "noexist": null
        }
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectHash",
              "children": [
                {
                  "type": "KeyValuePair",
                  "name": "noexist",
                  "value": {
                    "type": "Field",
                    "name": "noexist"
                  }
                },
                {
                  "type": "KeyValuePair",
                  "name": "alsonoexist",
                  "value": {
                    "type": "Field",
                    "name": "alsonoexist"
                  }
                }
              ]
            }
          ]
        },
        "result": {
          "noexist": null,
          "alsonoexist": null
        }
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Field",
                  "name": "badkey"
                }
              ]
            },
            {
              "type": "MultiSelectHash",
              "children": [
                {
                  "type": "KeyValuePair",
                  "name": "nokey",
                  "value": {
                    "type": "Field",
                    "name": "nokey"
                  }
                },
                {
                  "type": "KeyValuePair",
                  "name": "alsonokey",
                  "value": {
                    "type": "Field",
                    "name": "alsonokey"
                  }
                }
              ]
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "ValueProjection",
          "children": [
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Field",
                  "name": "nested"
                }
              ]
            },
            {
              "type": "MultiSelectHash",
              "children": [
                {
                  "type": "KeyValuePair",
                  "name": "a",
                  "value": {
                    "type": "Field",
                    "name": "a"
                  }
                },
                {
                  "type": "KeyValuePair",
                  "name": "b",
                  "value": {
                    "type": "Field",
                    "name": "b"
                  }
                }
              ]
            }
          ]
        },
        "result": [
          {
            "a": "first",
            "b": "second"
          },
          {
            "a": "first",
            "b": "second"
          },
          {
            "a": "first",
            "b": "second"
          }
        ]
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Subexpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "foo"
                    },
                    {
                      "type": "Field",
                      "name": "nested"
                    }
                  ]
                },
                {
                  "type": "Field",
                  "name": "three"
                }
              ]
            },
            {
              "type": "MultiSelectHash",
              "children": [
                {
                  "type": "KeyValuePair",
                  "name": "a",
                  "value": {
                    "type": "Field",
                    "name": "a"
                  }
                },
                {
                  "type": "KeyValuePair",
                  "name": "cinner",
                  "value": {
                    "type": "Subexpression",
                    "children": [
                      {
                        "type": "Field",
                        "name": "c"
                      },
                      {
                        "type": "Field",
                        "name": "inner"
                      }
                    ]
                  }
                }
              ]
            }
          ]
        },
        "result": {
          "a": "first",
          "cinner": "third"
        }
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Subexpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "foo"
                    },
                    {
                      "type": "Field",
                      "name": "nested"
                    }
                  ]
                },
                {
                  "type": "Field",
                  "name": "three"
                }
              ]
            },
            {
              "type": "MultiSelectHash",
              "children": [
                {
                  "type": "KeyValuePair",
                  "name": "a",
                  "value": {
                    "type": "Field",
                    "name": "a"
                  }
                },
                {
                  "type": "KeyValuePair",
                  "name": "c",
                  "value": {
                    "type": "Subexpression",
                    "children": [
                      {
                        "type": "Subexpression",
                        "children": [
                          {
                            "type": "Subexpression",
                            "children": [
                              {
                                "type": "Field",
                                "name": "c"
                              },
                              {
                                "type": "Field",
                                "name": "inner"
                              }
                            ]
                          },
                          {
                            "type": "Field",
                            "name": "bad"
                          }
                        ]
                      },
                      {
                        "type": "Field",
                        "name": "key"
                      }
                    ]
                  }
                }
              ]
            }
          ]
        },
        "result": {
          "a": "first",
          "c": null
        }
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectHash",
              "children": [
                {
                  "type": "KeyValuePair",
                  "name": "a",
                  "value": {
                    "type": "Subexpression",
                    "children": [
                      {
                        "type": "Subexpression",
                        "children": [
                          {
                            "type": "Field",
                            "name": "nested"
                          },
                          {
                            "type": "Field",
                            "name": "one"
                          }
                        ]
                      },
                      {
                        "type": "Field",
                        "name": "a"
                      }
                    ]
                  }
                },
                {
                  "type": "KeyValuePair",
                  "name": "b",
                  "value": {
                    "type": "Subexpression",
                    "children": [
                      {
                        "type": "Subexpression",
                        "children": [
                          {
                            "type": "Field",
                            "name": "nested"
                          },
                          {
                            "type": "Field",
                            "name": "two"
                          }
                        ]
                      },
                      {
                        "type": "Field",
                        "name": "b"
                      }
                    ]
                  }
                }
              ]
            }
          ]
        },
        "result": {
          "a": "first",
          "b": "second"
        }
      },
      {
        "expression": {
          "type": "MultiSelectHash",
          "children": [
            {
              "type": "KeyValuePair",
              "name": "bar",
              "value": {
                "type": "Field",
                "name": "bar"
              }
            },
            {
              "type": "KeyValuePair",
              "name": "baz",
              "value": {
                "type": "Field",
                "name": "baz"
              }
            }
          ]
        },
        "result": {
          "bar": 1,
          "baz": 2
        }
      },
      {
        "expression": {
          "type": "MultiSelectHash",
          "children": [
            {
              "type": "KeyValuePair",
              "name": "bar",
              "value": {
                "type": "Field",
                "name": "bar"
              }
            }
          ]
        },
        "result": {
          "bar": 1
        }
      },
      {
        "expression": {
          "type": "MultiSelectHash",
          "children": [
            {
              "type": "KeyValuePair",
              "name": "otherkey",
              "value": {
                "type": "Field",
                "name": "bar"
              }
            }
          ]
        },
        "result": {
          "otherkey": 1
        }
      },
      {
        "expression": {
          "type": "MultiSelectHash",
          "children": [
            {
              "type": "KeyValuePair",
              "name": "no",
              "value": {
                "type": "Field",
                "name": "no"
              }
            },
            {
              "type": "KeyValuePair",
              "name": "exist",
              "value": {
                "type": "Field",
                "name": "exist"
              }
            }
          ]
        },
        "result": {
          "no": null,
          "exist": null
        }
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectList",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                }
              ]
            }
          ]
        },
        "result": [
          "bar"
        ]
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectList",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Field",
                  "name": "baz"
                }
              ]
            }
          ]
        },
        "result": [
          "bar",
          "baz"
        ]
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectList",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Field",
                  "name": "qux"
                }
              ]
            }
          ]
        },
        "result": [
          "bar",
          "qux"
        ]
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectList",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Field",
                  "name": "noexist"
                }
              ]
            }
          ]
        },
        "result": [
          "bar",
          null
        ]
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectList",
              "children": [
                {
                  "type": "Field",
                  "name": "noexist"
                },
                {
                  "type": "Field",
                  "name": "alsonoexist"
                }
              ]
            }
          ]
        },
        "result": [
          null,
          null
        ]
      }
    ]
  },
  {
    "given": {
      "foo": {
        "bar": 1,
        "baz": [
          2,
          3,
          4
        ]
      }
    },
    "cases": [
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectHash",
              "children": [
                {
                  "type": "KeyValuePair",
                  "name": "bar",
                  "value": {
                    "type": "Field",
                    "name": "bar"
                  }
                },
                {
                  "type": "KeyValuePair",
                  "name": "baz",
                  "value": {
                    "type": "Field",
                    "name": "baz"
                  }
                }
              ]
            }
          ]
        },
        "result": {
          "bar": 1,
          "baz": [
            2,
            3,
            4
          ]
        }
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectList",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "IndexExpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "baz"
                    },
                    {
                      "type": "Index",
                      "value": 0
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          1,
          2
        ]
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectList",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "IndexExpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "baz"
                    },
                    {
                      "type": "Index",
                      "value": 1
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          1,
          3
        ]
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectList",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "IndexExpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "baz"
                    },
                    {
                      "type": "Index",
                      "value": 2
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          1,
          4
        ]
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectList",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "IndexExpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "baz"
                    },
                    {
                      "type": "Index",
                      "value": 3
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          1,
          null
        ]
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectList",
              "children": [
                {
                  "type": "IndexExpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "bar"
                    },
                    {
                      "type": "Index",
                      "value": 0
                    }
                  ]
                },
                {
                  "type": "IndexExpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "baz"
                    },
                    {
                      "type": "Index",
                      "value": 3
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          null,
          null
        ]
      }
    ]
  },
  {
    "given": {
      "foo": {
        "bar": 1,
        "baz": 2
      }
    },
    "cases": [
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectHash",
              "children": [
                {
                  "type": "KeyValuePair",
                  "name": "bar",
                  "value": {
                    "type": "Field",
                    "name": "bar"
                  }
                },
                {
                  "type": "KeyValuePair",
                  "name": "baz",
                  "value": {
                    "type": "Field",
                    "name": "baz"
                  }
                }
              ]
            }
          ]
        },
        "result": {
          "bar": 1,
          "baz": 2
        }
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectList",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Field",
                  "name": "baz"
                }
              ]
            }
          ]
        },
        "result": [
          1,
          2
        ]
      }
    ]
  },
  {
    "given": {
      "foo": {
        "bar": {
          "baz": [
            {
              "common": "first",
              "one": 1
            },
            {
              "common": "second",
              "two": 2
            }
          ]
        },
        "ignoreme": 1,
        "includeme": true
      }
    },
    "cases": [
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectHash",
              "children": [
                {
                  "type": "KeyValuePair",
                  "name": "bar",
                  "value": {
                    "type": "Subexpression",
                    "children": [
                      {
                        "type": "Field",
                        "name": "bar"
                      },
                      {
                        "type": "IndexExpression",
                        "children": [
                          {
                            "type": "Field",
                            "name": "baz"
                          },
                          {
                            "type": "Index",
                            "value": 1
                          }
                        ]
                      }
                    ]
                  }
                },
                {
                  "type": "KeyValuePair",
                  "name": "includeme",
                  "value": {
                    "type": "Field",
                    "name": "includeme"
                  }
                }
              ]
            }
          ]
        },
        "result": {
          "bar": {
            "common": "second",
            "two": 2
          },
          "includeme": true
        }
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectHash",
              "children": [
                {
                  "type": "KeyValuePair",
                  "name": "bar.baz.two",
                  "value": {
                    "type": "Subexpression",
                    "children": [
                      {
                        "type": "Subexpression",
                        "children": [
                          {
                            "type": "Field",
                            "name": "bar"
                          },
                          {
                            "type": "IndexExpression",
                            "children": [
                              {
                                "type": "Field",
                                "name": "baz"
                              },
                              {
                                "type": "Index",
                                "value": 1
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "Field",
                        "name": "two"
                      }
                    ]
                  }
                },
                {
                  "type": "KeyValuePair",
                  "name": "includeme",
                  "value": {
                    "type": "Field",
                    "name": "includeme"
                  }
                }
              ]
            }
          ]
        },
        "result": {
          "bar.baz.two": 2,
          "includeme": true
        }
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectList",
              "children": [
                {
                  "type": "Field",
                  "name": "includeme"
                },
                {
                  "type": "Subexpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "bar"
                    },
                    {
                      "type": "Projection",
                      "children": [
                        {
                          "type": "Field",
                          "name": "baz"
                        },
                        {
                          "type": "Field",
                          "name": "common"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          true,
          [
            "first",
            "second"
          ]
        ]
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectList",
              "children": [
                {
                  "type": "Field",
                  "name": "includeme"
                },
                {
                  "type": "Subexpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "bar"
                    },
                    {
                      "type": "Projection",
                      "children": [
                        {
                          "type": "Field",
                          "name": "baz"
                        },
                        {
                          "type": "Field",
                          "name": "none"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          true,
          []
        ]
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectList",
              "children": [
                {
                  "type": "Field",
                  "name": "includeme"
                },
                {
                  "type": "Projection",
                  "children": [
                    {
                      "type": "Flatten",
                      "children": [
                        {
                          "type": "Subexpression",
                          "children": [
                            {
                              "type": "Field",
                              "name": "bar"
                            },
                            {
                              "type": "Field",
                              "name": "baz"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "Field",
                      "name": "common"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          true,
          [
            "first",
            "second"
          ]
        ]
      }
    ]
  },
  {
    "given": {
      "reservations": [
        {
          "instances": [
            {
              "id": "id1",
              "name": "first"
            },
            {
              "id": "id2",
              "name": "second"
            }
          ]
        },
        {
          "instances": [
            {
              "id": "id3",
              "name": "third"
            },
            {
              "id": "id4",
              "name": "fourth"
            }
          ]
        }
      ]
    },
    "cases": [
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "reservations"
            },
            {
              "type": "Projection",
              "children": [
                {
                  "type": "Field",
                  "name": "instances"
                },
                {
                  "type": "MultiSelectHash",
                  "children": [
                    {
                      "type": "KeyValuePair",
                      "name": "id",
                      "value": {
                        "type": "Field",
                        "name": "id"
                      }
                    },
                    {
                      "type": "KeyValuePair",
                      "name": "name",
                      "value": {
                        "type": "Field",
                        "name": "name"
                      }
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          [
            {
              "id": "id1",
              "name": "first"
            },
            {
              "id": "id2",
              "name": "second"
            }
          ],
          [
            {
              "id": "id3",
              "name": "third"
            },
            {
              "id": "id4",
              "name": "fourth"
            }
          ]
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Projection",
                  "children": [
                    {
                      "type": "Flatten",
                      "children": [
                        {
                          "type": "Field",
                          "name": "reservations"
                        }
                      ]
                    },
                    {
                      "type": "Field",
                      "name": "instances"
                    }
                  ]
                }
              ]
            },
            {
              "type": "MultiSelectHash",
              "children": [
                {
                  "type": "KeyValuePair",
                  "name": "id",
                  "value": {
                    "type": "Field",
                    "name": "id"
                  }
                },
                {
                  "type": "KeyValuePair",
                  "name": "name",
                  "value": {
                    "type": "Field",
                    "name": "name"
                  }
                }
              ]
            }
          ]
        },
        "result": [
          {
            "id": "id1",
            "name": "first"
          },
          {
            "id": "id2",
            "name": "second"
          },
          {
            "id": "id3",
            "name": "third"
          },
          {
            "id": "id4",
            "name": "fourth"
          }
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Projection",
                  "children": [
                    {
                      "type": "Flatten",
                      "children": [
                        {
                          "type": "Field",
                          "name": "reservations"
                        }
                      ]
                    },
                    {
                      "type": "Field",
                      "name": "instances"
                    }
                  ]
                }
              ]
            },
            {
              "type": "MultiSelectList",
              "children": [
                {
                  "type": "Field",
                  "name": "id"
                },
                {
                  "type": "Field",
                  "name": "name"
                }
              ]
            }
          ]
        },
        "result": [
          [
            "id1",
            "first"
          ],
          [
            "id2",
            "second"
          ],
          [
            "id3",
            "third"
          ],
          [
            "id4",
            "fourth"
          ]
        ]
      }
    ]
  },
  {
    "given": {
      "foo": [
        {
          "bar": [
            {
              "qux": 2,
              "baz": 1
            },
            {
              "qux": 4,
              "baz": 3
            }
          ]
        },
        {
          "bar": [
            {
              "qux": 6,
              "baz": 5
            },
            {
              "qux": 8,
              "baz": 7
            }
          ]
        }
      ]
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "foo"
        },
        "result": [
          {
            "bar": [
              {
                "qux": 2,
                "baz": 1
              },
              {
                "qux": 4,
                "baz": 3
              }
            ]
          },
          {
            "bar": [
              {
                "qux": 6,
                "baz": 5
              },
              {
                "qux": 8,
                "baz": 7
              }
            ]
          }
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          {
            "bar": [
              {
                "qux": 2,
                "baz": 1
              },
              {
                "qux": 4,
                "baz": 3
              }
            ]
          },
          {
            "bar": [
              {
                "qux": 6,
                "baz": 5
              },
              {
                "qux": 8,
                "baz": 7
              }
            ]
          }
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                }
              ]
            },
            {
              "type": "Field",
              "name": "bar"
            }
          ]
        },
        "result": [
          [
            {
              "qux": 2,
              "baz": 1
            },
            {
              "qux": 4,
              "baz": 3
            }
          ],
          [
            {
              "qux": 6,
              "baz": 5
            },
            {
              "qux": 8,
              "baz": 7
            }
          ]
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Projection",
                  "children": [
                    {
                      "type": "Flatten",
                      "children": [
                        {
                          "type": "Field",
                          "name": "foo"
                        }
                      ]
                    },
                    {
                      "type": "Field",
                      "name": "bar"
                    }
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          {
            "qux": 2,
            "baz": 1
          },
          {
            "qux": 4,
            "baz": 3
          },
          {
            "qux": 6,
            "baz": 5
          },
          {
            "qux": 8,
            "baz": 7
          }
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Projection",
                  "children": [
                    {
                      "type": "Flatten",
                      "children": [
                        {
                          "type": "Field",
                          "name": "foo"
                        }
                      ]
                    },
                    {
                      "type": "Field",
                      "name": "bar"
                    }
                  ]
                }
              ]
            },
            {
              "type": "MultiSelectList",
              "children": [
                {
                  "type": "Field",
                  "name": "baz"
                },
                {
                  "type": "Field",
                  "name": "qux"
                }
              ]
            }
          ]
        },
        "result": [
          [
            1,
            2
          ],
          [
            3,
            4
          ],
          [
            5,
            6
          ],
          [
            7,
            8
          ]
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Projection",
                  "children": [
                    {
                      "type": "Flatten",
                      "children": [
                        {
                          "type": "Field",
                          "name": "foo"
                        }
                      ]
                    },
                    {
                      "type": "Field",
                      "name": "bar"
                    }
                  ]
                }
              ]
            },
            {
              "type": "MultiSelectList",
              "children": [
                {
                  "type": "Field",
                  "name": "baz"
                }
              ]
            }
          ]
        },
        "result": [
          [
            1
          ],
          [
            3
          ],
          [
            5
          ],
          [
            7
          ]
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Projection",
                  "children": [
                    {
                      "type": "Flatten",
                      "children": [
                        {
                          "type": "Projection",
                          "children": [
                            {
                              "type": "Flatten",
                              "children": [
                                {
                                  "type": "Field",
                                  "name": "foo"
                                }
                              ]
                            },
                            {
                              "type": "Field",
                              "name": "bar"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "MultiSelectList",
                      "children": [
                        {
                          "type": "Field",
                          "name": "baz"
                        },
                        {
                          "type": "Field",
                          "name": "qux"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8
        ]
      }
    ]
  },
  {
    "given": {
      "foo": {
        "baz": [
          {
            "bar": "abc"
          },
          {
            "bar": "def"
          }
        ],
        "qux": [
          "zero"
        ]
      }
    },
    "cases": [
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectList",
              "children": [
                {
                  "type": "Projection",
                  "children": [
                    {
                      "type": "Field",
                      "name": "baz"
                    },
                    {
                      "type": "Field",
                      "name": "bar"
                    }
                  ]
                },
                {
                  "type": "IndexExpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "qux"
                    },
                    {
                      "type": "Index",
                      "value": 0
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          [
            "abc",
            "def"
          ],
          "zero"
        ]
      }
    ]
  },
  {
    "given": {
      "foo": {
        "baz": [
          {
            "bar": "a",
            "bam": "b",
            "boo": "c"
          },
          {
            "bar": "d",
            "bam": "e",
            "boo": "f"
          }
        ],
        "qux": [
          "zero"
        ]
      }
    },
    "cases": [
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectList",
              "children": [
                {
                  "type": "Projection",
                  "children": [
                    {
                      "type": "Field",
                      "name": "baz"
                    },
                    {
                      "type": "MultiSelectList",
                      "children": [
                        {
                          "type": "Field",
                          "name": "bar"
                        },
                        {
                          "type": "Field",
                          "name": "boo"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "IndexExpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "qux"
                    },
                    {
                      "type": "Index",
                      "value": 0
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          [
            [
              "a",
              "c"
            ],
            [
              "d",
              "f"
            ]
          ],
          "zero"
        ]
      }
    ]
  },
  {
    "given": {
      "foo": {
        "baz": [
          {
            "bar": "a",
            "bam": "b",
            "boo": "c"
          },
          {
            "bar": "d",
            "bam": "e",
            "boo": "f"
          }
        ],
        "qux": [
          "zero"
        ]
      }
    },
    "cases": [
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectList",
              "children": [
                {
                  "type": "OrExpression",
                  "children": [
                    {
                      "type": "Projection",
                      "children": [
                        {
                          "type": "Field",
                          "name": "baz"
                        },
                        {
                          "type": "Field",
                          "name": "not_there"
                        }
                      ]
                    },
                    {
                      "type": "Projection",
                      "children": [
                        {
                          "type": "Field",
                          "name": "baz"
                        },
                        {
                          "type": "Field",
                          "name": "bar"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "IndexExpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "qux"
                    },
                    {
                      "type": "Index",
                      "value": 0
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          [
            "a",
            "d"
          ],
          "zero"
        ]
      }
    ]
  },
  {
    "given": {
      "type": "object"
    },
    "cases": [
      {
        "comment": "Nested multiselect",
        "expression": {
          "type": "MultiSelectList",
          "children": [
            {
              "type": "Projection",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Identity"
                }
              ]
            },
            {
              "type": "ValueProjection",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Identity"
                }
              ]
            }
          ]
        },
        "result": [
          null,
          [
            "object"
          ]
        ]
      }
    ]
  },
  {
    "given": [],
    "cases": [
      {
        "comment": "Nested multiselect",
        "expression": {
          "type": "MultiSelectList",
          "children": [
            {
              "type": "Projection",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Identity"
                }
              ]
            }
          ]
        },
        "result": [
          []
        ]
      }
    ]
  },
  {
    "given": {
      "foo": {
        "bar": {
          "baz": "subkey"
        },
        "other": {
          "baz": "subkey"
        },
        "other2": {
          "baz": "subkey"
        },
        "other3": {
          "notbaz": [
            "a",
            "b",
            "c"
          ]
        },
        "other4": {
          "notbaz": [
            "a",
            "b",
            "c"
          ]
        }
      }
    },
    "cases": [
      {
        "expression": {
          "type": "Pipe",
          "children": [
            {
              "type": "ValueProjection",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Field",
                  "name": "baz"
                }
              ]
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": "subkey"
      },
      {
        "expression": {
          "type": "Pipe",
          "children": [
            {
              "type": "ValueProjection",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Field",
                  "name": "baz"
                }
              ]
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Index",
                  "value": 1
                }
              ]
            }
          ]
        },
        "result": "subkey"
      },
      {
        "expression": {
          "type": "Pipe",
          "children": [
            {
              "type": "ValueProjection",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Field",
                  "name": "baz"
                }
              ]
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Index",
                  "value": 2
                }
              ]
            }
          ]
        },
        "result": "subkey"
      },
      {
        "expression": {
          "type": "Pipe",
          "children": [
            {
              "type": "ValueProjection",
              "children": [
                {
                  "type": "Subexpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "foo"
                    },
                    {
                      "type": "Field",
                      "name": "bar"
                    }
                  ]
                },
                {
                  "type": "Identity"
                }
              ]
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": "subkey"
      },
      {
        "expression": {
          "type": "Pipe",
          "children": [
            {
              "type": "ValueProjection",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Field",
                  "name": "notbaz"
                }
              ]
            },
            {
              "type": "Projection",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Identity"
                }
              ]
            }
          ]
        },
        "result": [
          [
            "a",
            "b",
            "c"
          ],
          [
            "a",
            "b",
            "c"
          ]
        ]
      },
      {
        "expression": {
          "type": "Pipe",
          "children": [
            {
              "type": "MultiSelectHash",
              "children": [
                {
                  "type": "KeyValuePair",
                  "name": "a",
                  "value": {
                    "type": "Subexpression",
                    "children": [
                      {
                        "type": "Field",
                        "name": "foo"
                      },
                      {
                        "type": "Field",
                        "name": "bar"
                      }
                    ]
                  }
                },
                {
                  "type": "KeyValuePair",
                  "name": "b",
                  "value": {
                    "type": "Subexpression",
                    "children": [
                      {
                        "type": "Field",
                        "name": "foo"
                      },
                      {
                        "type": "Field",
                        "name": "other"
                      }
                    ]
                  }
                }
              ]
            },
            {
              "type": "ValueProjection",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Field",
                  "name": "baz"
                }
              ]
            }
          ]
        },
        "result": [
          "subkey",
          "subkey"
        ]
      }
    ]
  },
  {
    "given": {
      "foo": {
        "bar": {
          "baz": "one"
        },
        "other": {
          "baz": "two"
        },
        "other2": {
          "baz": "three"
        },
        "other3": {
          "notbaz": [
            "a",
            "b",
            "c"
          ]
        },
        "other4": {
          "notbaz": [
            "d",
            "e",
            "f"
          ]
        }
      }
    },
    "cases": [
      {
        "expression": {
          "type": "Pipe",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Field",
              "name": "bar"
            }
          ]
        },
        "result": {
          "baz": "one"
        }
      },
      {
        "expression": {
          "type": "Pipe",
          "children": [
            {
              "type": "Pipe",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Field",
                  "name": "bar"
                }
              ]
            },
            {
              "type": "Field",
              "name": "baz"
            }
          ]
        },
        "result": "one"
      },
      {
        "expression": {
          "type": "Pipe",
          "children": [
            {
              "type": "Pipe",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Field",
                  "name": "bar"
                }
              ]
            },
            {
              "type": "Field",
              "name": "baz"
            }
          ]
        },
        "result": "one"
      },
      {
        "expression": {
          "type": "Pipe",
          "children": [
            {
              "type": "Field",
              "name": "not_there"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Pipe",
          "children": [
            {
              "type": "Field",
              "name": "not_there"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Pipe",
          "children": [
            {
              "type": "MultiSelectList",
              "children": [
                {
                  "type": "Subexpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "foo"
                    },
                    {
                      "type": "Field",
                      "name": "bar"
                    }
                  ]
                },
                {
                  "type": "Subexpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "foo"
                    },
                    {
                      "type": "Field",
                      "name": "other"
                    }
                  ]
                }
              ]
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": {
          "baz": "one"
        }
      },
      {
        "expression": {
          "type": "Pipe",
          "children": [
            {
              "type": "MultiSelectHash",
              "children": [
                {
                  "type": "KeyValuePair",
                  "name": "a",
                  "value": {
                    "type": "Subexpression",
                    "children": [
                      {
                        "type": "Field",
                        "name": "foo"
                      },
                      {
                        "type": "Field",
                        "name": "bar"
                      }
                    ]
                  }
                },
                {
                  "type": "KeyValuePair",
                  "name": "b",
                  "value": {
                    "type": "Subexpression",
                    "children": [
                      {
                        "type": "Field",
                        "name": "foo"
                      },
                      {
                        "type": "Field",
                        "name": "other"
                      }
                    ]
                  }
                }
              ]
            },
            {
              "type": "Field",
              "name": "a"
            }
          ]
        },
        "result": {
          "baz": "one"
        }
      },
      {
        "expression": {
          "type": "Pipe",
          "children": [
            {
              "type": "MultiSelectHash",
              "children": [
                {
                  "type": "KeyValuePair",
                  "name": "a",
                  "value": {
                    "type": "Subexpression",
                    "children": [
                      {
                        "type": "Field",
                        "name": "foo"
                      },
                      {
                        "type": "Field",
                        "name": "bar"
                      }
                    ]
                  }
                },
                {
                  "type": "KeyValuePair",
                  "name": "b",
                  "value": {
                    "type": "Subexpression",
                    "children": [
                      {
                        "type": "Field",
                        "name": "foo"
                      },
                      {
                        "type": "Field",
                        "name": "other"
                      }
                    ]
                  }
                }
              ]
            },
            {
              "type": "Field",
              "name": "b"
            }
          ]
        },
        "result": {
          "baz": "two"
        }
      },
      {
        "expression": {
          "type": "Pipe",
          "children": [
            {
              "type": "OrExpression",
              "children": [
                {
                  "type": "Subexpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "foo"
                    },
                    {
                      "type": "Field",
                      "name": "bam"
                    }
                  ]
                },
                {
                  "type": "Subexpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "foo"
                    },
                    {
                      "type": "Field",
                      "name": "bar"
                    }
                  ]
                }
              ]
            },
            {
              "type": "Field",
              "name": "baz"
            }
          ]
        },
        "result": "one"
      },
      {
        "expression": {
          "type": "Pipe",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "OrExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "not_there"
                },
                {
                  "type": "Field",
                  "name": "bar"
                }
              ]
            }
          ]
        },
        "result": {
          "baz": "one"
        }
      }
    ]
  },
  {
    "given": {
      "foo": [
        {
          "bar": [
            {
              "baz": "one"
            },
            {
              "baz": "two"
            }
          ]
        },
        {
          "bar": [
            {
              "baz": "three"
            },
            {
              "baz": "four"
            }
          ]
        }
      ]
    },
    "cases": [
      {
        "expression": {
          "type": "Pipe",
          "children": [
            {
              "type": "Projection",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Projection",
                  "children": [
                    {
                      "type": "Field",
                      "name": "bar"
                    },
                    {
                      "type": "Identity"
                    }
                  ]
                }
              ]
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "IndexExpression",
                  "children": [
                    {
                      "type": "Identity"
                    },
                    {
                      "type": "Index",
                      "value": 0
                    }
                  ]
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": {
          "baz": "one"
        }
      }
    ]
  },
  {
    "given": {
      "foo": [
        0,
        1,
        2,
        3,
        4,
        5,
        6,
        7,
        8,
        9
      ],
      "bar": {
        "baz": 1
      }
    },
    "cases": [
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Slice",
                  "children": [
                    0,
                    10,
                    null
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Slice",
                  "children": [
                    0,
                    10,
                    1
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          0,
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Slice",
                  "children": [
                    0,
                    10,
                    null
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          0,
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Slice",
                  "children": [
                    0,
                    10,
                    null
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          0,
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Slice",
                  "children": [
                    0,
                    null,
                    1
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          0,
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Slice",
                  "children": [
                    0,
                    null,
                    null
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          0,
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Slice",
                  "children": [
                    0,
                    null,
                    null
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          0,
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Slice",
                  "children": [
                    null,
                    10,
                    1
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          0,
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Slice",
                  "children": [
                    null,
                    null,
                    1
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          0,
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Slice",
                  "children": [
                    null,
                    10,
                    null
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          0,
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Slice",
                  "children": [
                    null,
                    null,
                    null
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          0,
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Slice",
                  "children": [
                    null,
                    null,
                    null
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          0,
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Slice",
                  "children": [
                    1,
                    9,
                    null
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Slice",
                  "children": [
                    0,
                    10,
                    2
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          0,
          2,
          4,
          6,
          8
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Slice",
                  "children": [
                    5,
                    null,
                    null
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          5,
          6,
          7,
          8,
          9
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Slice",
                  "children": [
                    5,
                    null,
                    2
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          5,
          7,
          9
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Slice",
                  "children": [
                    null,
                    null,
                    2
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          0,
          2,
          4,
          6,
          8
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Slice",
                  "children": [
                    null,
                    null,
                    -1
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          9,
          8,
          7,
          6,
          5,
          4,
          3,
          2,
          1,
          0
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Slice",
                  "children": [
                    1,
                    null,
                    2
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          1,
          3,
          5,
          7,
          9
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Slice",
                  "children": [
                    10,
                    0,
                    -1
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          9,
          8,
          7,
          6,
          5,
          4,
          3,
          2,
          1
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Slice",
                  "children": [
                    10,
                    5,
                    -1
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          9,
          8,
          7,
          6
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Slice",
                  "children": [
                    8,
                    2,
                    -2
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          8,
          6,
          4
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Slice",
                  "children": [
                    0,
                    20,
                    null
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          0,
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Slice",
                  "children": [
                    10,
                    -20,
                    -1
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          9,
          8,
          7,
          6,
          5,
          4,
          3,
          2,
          1,
          0
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Slice",
                  "children": [
                    10,
                    -20,
                    null
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": []
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Slice",
                  "children": [
                    -4,
                    -1,
                    null
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          6,
          7,
          8
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Slice",
                  "children": [
                    null,
                    -5,
                    -1
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          9,
          8,
          7,
          6
        ]
      }
    ]
  },
  {
    "given": {
      "foo": [
        {
          "a": 1
        },
        {
          "a": 2
        },
        {
          "a": 3
        }
      ],
      "bar": [
        {
          "a": {
            "b": 1
          }
        },
        {
          "a": {
            "b": 2
          }
        },
        {
          "a": {
            "b": 3
          }
        }
      ],
      "baz": 50
    },
    "cases": [
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Slice",
                  "children": [
                    null,
                    2,
                    null
                  ]
                }
              ]
            },
            {
              "type": "Field",
              "name": "a"
            }
          ]
        },
        "result": [
          1,
          2
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Slice",
                  "children": [
                    null,
                    2,
                    null
                  ]
                }
              ]
            },
            {
              "type": "Field",
              "name": "b"
            }
          ]
        },
        "result": []
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Slice",
                  "children": [
                    null,
                    2,
                    null
                  ]
                }
              ]
            },
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "a"
                },
                {
                  "type": "Field",
                  "name": "b"
                }
              ]
            }
          ]
        },
        "result": []
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Slice",
                  "children": [
                    null,
                    null,
                    -1
                  ]
                }
              ]
            },
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "a"
                },
                {
                  "type": "Field",
                  "name": "b"
                }
              ]
            }
          ]
        },
        "result": [
          3,
          2,
          1
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Slice",
                  "children": [
                    null,
                    2,
                    null
                  ]
                }
              ]
            },
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "a"
                },
                {
                  "type": "Field",
                  "name": "b"
                }
              ]
            }
          ]
        },
        "result": [
          1,
          2
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "baz"
                },
                {
                  "type": "Slice",
                  "children": [
                    null,
                    2,
                    null
                  ]
                }
              ]
            },
            {
              "type": "Field",
              "name": "a"
            }
          ]
        },
        "result": null
      }
    ]
  },
  {
    "given": [
      {
        "a": 1
      },
      {
        "a": 2
      },
      {
        "a": 3
      }
    ],
    "cases": [
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Slice",
                  "children": [
                    null,
                    null,
                    null
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          {
            "a": 1
          },
          {
            "a": 2
          },
          {
            "a": 3
          }
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Slice",
                  "children": [
                    null,
                    2,
                    null
                  ]
                }
              ]
            },
            {
              "type": "Field",
              "name": "a"
            }
          ]
        },
        "result": [
          1,
          2
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Slice",
                  "children": [
                    null,
                    null,
                    -1
                  ]
                }
              ]
            },
            {
              "type": "Field",
              "name": "a"
            }
          ]
        },
        "result": [
          3,
          2,
          1
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Slice",
                  "children": [
                    null,
                    2,
                    null
                  ]
                }
              ]
            },
            {
              "type": "Field",
              "name": "b"
            }
          ]
        },
        "result": []
      }
    ]
  },
  {
    "comment": "Dot syntax",
    "given": {
      "type": "object"
    },
    "cases": [
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Field",
              "name": "bar"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Field",
          "name": "foo"
        },
        "result": null
      }
    ]
  },
  {
    "comment": "Simple token errors",
    "given": {
      "type": "object"
    },
    "cases": []
  },
  {
    "comment": "Boolean syntax errors",
    "given": {
      "type": "object"
    },
    "cases": []
  },
  {
    "comment": "Wildcard syntax",
    "given": {
      "type": "object"
    },
    "cases": [
      {
        "expression": {
          "type": "ValueProjection",
          "children": [
            {
              "type": "Identity"
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          "object"
        ]
      },
      {
        "expression": {
          "type": "ValueProjection",
          "children": [
            {
              "type": "Identity"
            },
            {
              "type": "ValueProjection",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Identity"
                }
              ]
            }
          ]
        },
        "result": []
      },
      {
        "expression": {
          "type": "ValueProjection",
          "children": [
            {
              "type": "Identity"
            },
            {
              "type": "Field",
              "name": "foo"
            }
          ]
        },
        "result": []
      },
      {
        "expression": {
          "type": "ValueProjection",
          "children": [
            {
              "type": "Identity"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": []
      }
    ]
  },
  {
    "comment": "Flatten syntax",
    "given": {
      "type": "object"
    },
    "cases": [
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Identity"
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": null
      }
    ]
  },
  {
    "comment": "Simple bracket syntax",
    "given": {
      "type": "object"
    },
    "cases": [
      {
        "expression": {
          "type": "IndexExpression",
          "children": [
            {
              "type": "Identity"
            },
            {
              "type": "Index",
              "value": 0
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Identity"
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "ValueProjection",
          "children": [
            {
              "type": "Identity"
            },
            {
              "type": "MultiSelectList",
              "children": [
                {
                  "type": "Field",
                  "name": "0"
                }
              ]
            }
          ]
        },
        "result": [
          [
            null
          ]
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Identity"
            },
            {
              "type": "Field",
              "name": "bar"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Identity"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": null
      }
    ]
  },
  {
    "comment": "Multi-select list syntax",
    "given": {
      "type": "object"
    },
    "cases": [
      {
        "expression": {
          "type": "IndexExpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Index",
              "value": 0
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectList",
              "children": [
                {
                  "type": "ValueProjection",
                  "children": [
                    {
                      "type": "Identity"
                    },
                    {
                      "type": "Identity"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": null
      },
      {
        "comment": "Valid multi-select of a hash using an identifier index",
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectList",
              "children": [
                {
                  "type": "Field",
                  "name": "abc"
                }
              ]
            }
          ]
        },
        "result": null
      },
      {
        "comment": "Valid multi-select of a hash",
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectList",
              "children": [
                {
                  "type": "Field",
                  "name": "abc"
                },
                {
                  "type": "Field",
                  "name": "def"
                }
              ]
            }
          ]
        },
        "result": null
      }
    ]
  },
  {
    "comment": "Multi-select hash syntax",
    "given": {
      "type": "object"
    },
    "cases": [
      {
        "comment": "Valid multi-select hash extraction",
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "a"
            },
            {
              "type": "MultiSelectHash",
              "children": [
                {
                  "type": "KeyValuePair",
                  "name": "foo",
                  "value": {
                    "type": "Field",
                    "name": "bar"
                  }
                }
              ]
            }
          ]
        },
        "result": null
      },
      {
        "comment": "Valid multi-select hash extraction",
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "a"
            },
            {
              "type": "MultiSelectHash",
              "children": [
                {
                  "type": "KeyValuePair",
                  "name": "foo",
                  "value": {
                    "type": "Field",
                    "name": "bar"
                  }
                },
                {
                  "type": "KeyValuePair",
                  "name": "baz",
                  "value": {
                    "type": "Field",
                    "name": "bam"
                  }
                }
              ]
            }
          ]
        },
        "result": null
      },
      {
        "comment": "Nested multi select",
        "expression": {
          "type": "MultiSelectHash",
          "children": [
            {
              "type": "KeyValuePair",
              "name": "\\",
              "value": {
                "type": "MultiSelectHash",
                "children": [
                  {
                    "type": "KeyValuePair",
                    "name": " ",
                    "value": {
                      "type": "ValueProjection",
                      "children": [
                        {
                          "type": "Identity"
                        },
                        {
                          "type": "Identity"
                        }
                      ]
                    }
                  }
                ]
              }
            }
          ]
        },
        "result": {
          "\\": {
            " ": [
              "object"
            ]
          }
        }
      }
    ]
  },
  {
    "comment": "Or expressions",
    "given": {
      "type": "object"
    },
    "cases": [
      {
        "expression": {
          "type": "OrExpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Field",
              "name": "bar"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "MultiSelectList",
              "children": [
                {
                  "type": "OrExpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "a"
                    },
                    {
                      "type": "Field",
                      "name": "b"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": null
      }
    ]
  },
  {
    "comment": "Filter expressions",
    "given": {
      "type": "object"
    },
    "cases": [
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Literal",
                  "value": "baz"
                }
              ]
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Literal",
                  "value": "baz"
                }
              ]
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Subexpression",
                  "children": [
                    {
                      "type": "Subexpression",
                      "children": [
                        {
                          "type": "Field",
                          "name": "a"
                        },
                        {
                          "type": "Field",
                          "name": "b"
                        }
                      ]
                    },
                    {
                      "type": "Field",
                      "name": "c"
                    }
                  ]
                },
                {
                  "type": "Subexpression",
                  "children": [
                    {
                      "type": "Subexpression",
                      "children": [
                        {
                          "type": "Field",
                          "name": "d"
                        },
                        {
                          "type": "Field",
                          "name": "e"
                        }
                      ]
                    },
                    {
                      "type": "Field",
                      "name": "f"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Literal",
                  "value": [
                    0,
                    1,
                    2
                  ]
                }
              ]
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Literal",
                  "value": [
                    "a",
                    "b",
                    "c"
                  ]
                }
              ]
            }
          ]
        },
        "result": null
      },
      {
        "comment": "Literal char escaped",
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "EQ",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Literal",
                  "value": [
                    "foo`bar"
                  ]
                }
              ]
            }
          ]
        },
        "result": null
      },
      {
        "comment": "Quoted identifier in filter expression no spaces",
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Identity"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "GT",
              "children": [
                {
                  "type": "Field",
                  "name": "\\"
                },
                {
                  "type": "Literal",
                  "value": "foo"
                }
              ]
            }
          ]
        },
        "result": null
      },
      {
        "comment": "Quoted identifier in filter expression with spaces",
        "expression": {
          "type": "FilterProjection",
          "children": [
            {
              "type": "Identity"
            },
            {
              "type": "Identity"
            },
            {
              "type": "Comparator",
              "name": "GT",
              "children": [
                {
                  "type": "Field",
                  "name": "\\"
                },
                {
                  "type": "Literal",
                  "value": "foo"
                }
              ]
            }
          ]
        },
        "result": null
      }
    ]
  },
  {
    "comment": "Filter expression errors",
    "given": {
      "type": "object"
    },
    "cases": []
  },
  {
    "comment": "Identifiers",
    "given": {
      "type": "object"
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "foo"
        },
        "result": null
      },
      {
        "expression": {
          "type": "Field",
          "name": "foo"
        },
        "result": null
      },
      {
        "expression": {
          "type": "Field",
          "name": "\\"
        },
        "result": null
      }
    ]
  },
  {
    "comment": "Combined syntax",
    "given": [],
    "cases": [
      {
        "expression": {
          "type": "Pipe",
          "children": [
            {
              "type": "Pipe",
              "children": [
                {
                  "type": "OrExpression",
                  "children": [
                    {
                      "type": "ValueProjection",
                      "children": [
                        {
                          "type": "Identity"
                        },
                        {
                          "type": "Identity"
                        }
                      ]
                    },
                    {
                      "type": "ValueProjection",
                      "children": [
                        {
                          "type": "Identity"
                        },
                        {
                          "type": "Identity"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "ValueProjection",
                  "children": [
                    {
                      "type": "Identity"
                    },
                    {
                      "type": "Identity"
                    }
                  ]
                }
              ]
            },
            {
              "type": "ValueProjection",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Identity"
                }
              ]
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "OrExpression",
          "children": [
            {
              "type": "Projection",
              "children": [
                {
                  "type": "Flatten",
                  "children": [
                    {
                      "type": "ValueProjection",
                      "children": [
                        {
                          "type": "Identity"
                        },
                        {
                          "type": "Identity"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "Identity"
                }
              ]
            },
            {
              "type": "Projection",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Identity"
                }
              ]
            }
          ]
        },
        "result": []
      },
      {
        "expression": {
          "type": "MultiSelectList",
          "children": [
            {
              "type": "ValueProjection",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "ValueProjection",
                  "children": [
                    {
                      "type": "Identity"
                    },
                    {
                      "type": "Identity"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          null
        ]
      }
    ]
  },
  {
    "given": {
      "foo": [
        {
          "✓": "✓"
        },
        {
          "✓": "✗"
        }
      ]
    },
    "cases": [
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                }
              ]
            },
            {
              "type": "Field",
              "name": "✓"
            }
          ]
        },
        "result": [
          "✓",
          "✗"
        ]
      }
    ]
  },
  {
    "given": {
      "☯": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "☯"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "♪♫•*¨*•.¸¸❤¸¸.•*¨*•♫♪": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "♪♫•*¨*•.¸¸❤¸¸.•*¨*•♫♪"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "☃": true
    },
    "cases": [
      {
        "expression": {
          "type": "Field",
          "name": "☃"
        },
        "result": true
      }
    ]
  },
  {
    "given": {
      "foo": {
        "bar": {
          "baz": "val"
        },
        "other": {
          "baz": "val"
        },
        "other2": {
          "baz": "val"
        },
        "other3": {
          "notbaz": [
            "a",
            "b",
            "c"
          ]
        },
        "other4": {
          "notbaz": [
            "a",
            "b",
            "c"
          ]
        },
        "other5": {
          "other": {
            "a": 1,
            "b": 1,
            "c": 1
          }
        }
      }
    },
    "cases": [
      {
        "expression": {
          "type": "ValueProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Field",
              "name": "baz"
            }
          ]
        },
        "result": [
          "val",
          "val",
          "val"
        ]
      },
      {
        "expression": {
          "type": "ValueProjection",
          "children": [
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Field",
                  "name": "bar"
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          "val"
        ]
      },
      {
        "expression": {
          "type": "ValueProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Field",
              "name": "notbaz"
            }
          ]
        },
        "result": [
          [
            "a",
            "b",
            "c"
          ],
          [
            "a",
            "b",
            "c"
          ]
        ]
      },
      {
        "expression": {
          "type": "ValueProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "notbaz"
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": [
          "a",
          "a"
        ]
      },
      {
        "expression": {
          "type": "ValueProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "notbaz"
                },
                {
                  "type": "Index",
                  "value": -1
                }
              ]
            }
          ]
        },
        "result": [
          "c",
          "c"
        ]
      }
    ]
  },
  {
    "given": {
      "foo": {
        "first-1": {
          "second-1": "val"
        },
        "first-2": {
          "second-1": "val"
        },
        "first-3": {
          "second-1": "val"
        }
      }
    },
    "cases": [
      {
        "expression": {
          "type": "ValueProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          {
            "second-1": "val"
          },
          {
            "second-1": "val"
          },
          {
            "second-1": "val"
          }
        ]
      },
      {
        "expression": {
          "type": "ValueProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "ValueProjection",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Identity"
                }
              ]
            }
          ]
        },
        "result": [
          [
            "val"
          ],
          [
            "val"
          ],
          [
            "val"
          ]
        ]
      },
      {
        "expression": {
          "type": "ValueProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "ValueProjection",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "ValueProjection",
                  "children": [
                    {
                      "type": "Identity"
                    },
                    {
                      "type": "Identity"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          [],
          [],
          []
        ]
      },
      {
        "expression": {
          "type": "ValueProjection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "ValueProjection",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "ValueProjection",
                  "children": [
                    {
                      "type": "Identity"
                    },
                    {
                      "type": "ValueProjection",
                      "children": [
                        {
                          "type": "Identity"
                        },
                        {
                          "type": "Identity"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          [],
          [],
          []
        ]
      }
    ]
  },
  {
    "given": {
      "foo": {
        "bar": "one"
      },
      "other": {
        "bar": "one"
      },
      "nomatch": {
        "notbar": "three"
      }
    },
    "cases": [
      {
        "expression": {
          "type": "ValueProjection",
          "children": [
            {
              "type": "Identity"
            },
            {
              "type": "Field",
              "name": "bar"
            }
          ]
        },
        "result": [
          "one",
          "one"
        ]
      }
    ]
  },
  {
    "given": {
      "top1": {
        "sub1": {
          "foo": "one"
        }
      },
      "top2": {
        "sub1": {
          "foo": "one"
        }
      }
    },
    "cases": [
      {
        "expression": {
          "type": "ValueProjection",
          "children": [
            {
              "type": "Identity"
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          {
            "sub1": {
              "foo": "one"
            }
          },
          {
            "sub1": {
              "foo": "one"
            }
          }
        ]
      },
      {
        "expression": {
          "type": "ValueProjection",
          "children": [
            {
              "type": "Identity"
            },
            {
              "type": "Field",
              "name": "sub1"
            }
          ]
        },
        "result": [
          {
            "foo": "one"
          },
          {
            "foo": "one"
          }
        ]
      },
      {
        "expression": {
          "type": "ValueProjection",
          "children": [
            {
              "type": "Identity"
            },
            {
              "type": "ValueProjection",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Identity"
                }
              ]
            }
          ]
        },
        "result": [
          [
            {
              "foo": "one"
            }
          ],
          [
            {
              "foo": "one"
            }
          ]
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Flatten",
              "children": [
                {
                  "type": "ValueProjection",
                  "children": [
                    {
                      "type": "Identity"
                    },
                    {
                      "type": "ValueProjection",
                      "children": [
                        {
                          "type": "Identity"
                        },
                        {
                          "type": "Field",
                          "name": "foo"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          "one",
          "one"
        ]
      },
      {
        "expression": {
          "type": "ValueProjection",
          "children": [
            {
              "type": "Identity"
            },
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "sub1"
                },
                {
                  "type": "Field",
                  "name": "foo"
                }
              ]
            }
          ]
        },
        "result": [
          "one",
          "one"
        ]
      }
    ]
  },
  {
    "given": {
      "foo": [
        {
          "bar": "one"
        },
        {
          "bar": "two"
        },
        {
          "bar": "three"
        },
        {
          "notbar": "four"
        }
      ]
    },
    "cases": [
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Field",
              "name": "bar"
            }
          ]
        },
        "result": [
          "one",
          "two",
          "three"
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Field",
              "name": "notbar"
            }
          ]
        },
        "result": [
          "four"
        ]
      }
    ]
  },
  {
    "given": [
      {
        "bar": "one"
      },
      {
        "bar": "two"
      },
      {
        "bar": "three"
      },
      {
        "notbar": "four"
      }
    ],
    "cases": [
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Identity"
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          {
            "bar": "one"
          },
          {
            "bar": "two"
          },
          {
            "bar": "three"
          },
          {
            "notbar": "four"
          }
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Identity"
            },
            {
              "type": "Field",
              "name": "bar"
            }
          ]
        },
        "result": [
          "one",
          "two",
          "three"
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Identity"
            },
            {
              "type": "Field",
              "name": "notbar"
            }
          ]
        },
        "result": [
          "four"
        ]
      }
    ]
  },
  {
    "given": {
      "foo": {
        "bar": [
          {
            "baz": [
              "one",
              "two",
              "three"
            ]
          },
          {
            "baz": [
              "four",
              "five",
              "six"
            ]
          },
          {
            "baz": [
              "seven",
              "eight",
              "nine"
            ]
          }
        ]
      }
    },
    "cases": [
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Projection",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Field",
                  "name": "baz"
                }
              ]
            }
          ]
        },
        "result": [
          [
            "one",
            "two",
            "three"
          ],
          [
            "four",
            "five",
            "six"
          ],
          [
            "seven",
            "eight",
            "nine"
          ]
        ]
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Projection",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "IndexExpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "baz"
                    },
                    {
                      "type": "Index",
                      "value": 0
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          "one",
          "four",
          "seven"
        ]
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Projection",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "IndexExpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "baz"
                    },
                    {
                      "type": "Index",
                      "value": 1
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          "two",
          "five",
          "eight"
        ]
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Projection",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "IndexExpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "baz"
                    },
                    {
                      "type": "Index",
                      "value": 2
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": [
          "three",
          "six",
          "nine"
        ]
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Projection",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "IndexExpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "baz"
                    },
                    {
                      "type": "Index",
                      "value": 3
                    }
                  ]
                }
              ]
            }
          ]
        },
        "result": []
      }
    ]
  },
  {
    "given": {
      "foo": {
        "bar": [
          [
            "one",
            "two"
          ],
          [
            "three",
            "four"
          ]
        ]
      }
    },
    "cases": [
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Projection",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Identity"
                }
              ]
            }
          ]
        },
        "result": [
          [
            "one",
            "two"
          ],
          [
            "three",
            "four"
          ]
        ]
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": [
          "one",
          "two"
        ]
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "IndexExpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "bar"
                    },
                    {
                      "type": "Index",
                      "value": 0
                    }
                  ]
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": "one"
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "IndexExpression",
                  "children": [
                    {
                      "type": "IndexExpression",
                      "children": [
                        {
                          "type": "Field",
                          "name": "bar"
                        },
                        {
                          "type": "Index",
                          "value": 0
                        }
                      ]
                    },
                    {
                      "type": "Index",
                      "value": 0
                    }
                  ]
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Subexpression",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "IndexExpression",
                  "children": [
                    {
                      "type": "IndexExpression",
                      "children": [
                        {
                          "type": "IndexExpression",
                          "children": [
                            {
                              "type": "Field",
                              "name": "bar"
                            },
                            {
                              "type": "Index",
                              "value": 0
                            }
                          ]
                        },
                        {
                          "type": "Index",
                          "value": 0
                        }
                      ]
                    },
                    {
                      "type": "Index",
                      "value": 0
                    }
                  ]
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "IndexExpression",
          "children": [
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            },
            {
              "type": "Index",
              "value": 0
            }
          ]
        },
        "result": null
      }
    ]
  },
  {
    "given": {
      "foo": [
        {
          "bar": [
            {
              "kind": "basic"
            },
            {
              "kind": "intermediate"
            }
          ]
        },
        {
          "bar": [
            {
              "kind": "advanced"
            },
            {
              "kind": "expert"
            }
          ]
        },
        {
          "bar": "string"
        }
      ]
    },
    "cases": [
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Projection",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Field",
                  "name": "kind"
                }
              ]
            }
          ]
        },
        "result": [
          [
            "basic",
            "intermediate"
          ],
          [
            "advanced",
            "expert"
          ]
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "IndexExpression",
                  "children": [
                    {
                      "type": "Field",
                      "name": "bar"
                    },
                    {
                      "type": "Index",
                      "value": 0
                    }
                  ]
                },
                {
                  "type": "Field",
                  "name": "kind"
                }
              ]
            }
          ]
        },
        "result": [
          "basic",
          "advanced"
        ]
      }
    ]
  },
  {
    "given": {
      "foo": [
        {
          "bar": {
            "kind": "basic"
          }
        },
        {
          "bar": {
            "kind": "intermediate"
          }
        },
        {
          "bar": {
            "kind": "advanced"
          }
        },
        {
          "bar": {
            "kind": "expert"
          }
        },
        {
          "bar": "string"
        }
      ]
    },
    "cases": [
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "Subexpression",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Field",
                  "name": "kind"
                }
              ]
            }
          ]
        },
        "result": [
          "basic",
          "intermediate",
          "advanced",
          "expert"
        ]
      }
    ]
  },
  {
    "given": {
      "foo": [
        {
          "bar": [
            "one",
            "two"
          ]
        },
        {
          "bar": [
            "three",
            "four"
          ]
        },
        {
          "bar": [
            "five"
          ]
        }
      ]
    },
    "cases": [
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": [
          "one",
          "three",
          "five"
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Index",
                  "value": 1
                }
              ]
            }
          ]
        },
        "result": [
          "two",
          "four"
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Index",
                  "value": 2
                }
              ]
            }
          ]
        },
        "result": []
      }
    ]
  },
  {
    "given": {
      "foo": [
        {
          "bar": []
        },
        {
          "bar": []
        },
        {
          "bar": []
        }
      ]
    },
    "cases": [
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Field",
                  "name": "bar"
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": []
      }
    ]
  },
  {
    "given": {
      "foo": [
        [
          "one",
          "two"
        ],
        [
          "three",
          "four"
        ],
        [
          "five"
        ]
      ]
    },
    "cases": [
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": [
          "one",
          "three",
          "five"
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Index",
                  "value": 1
                }
              ]
            }
          ]
        },
        "result": [
          "two",
          "four"
        ]
      }
    ]
  },
  {
    "given": {
      "foo": [
        [
          [
            "one",
            "two"
          ],
          [
            "three",
            "four"
          ]
        ],
        [
          [
            "five",
            "six"
          ],
          [
            "seven",
            "eight"
          ]
        ],
        [
          [
            "nine"
          ],
          [
            "ten"
          ]
        ]
      ]
    },
    "cases": [
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": [
          [
            "one",
            "two"
          ],
          [
            "five",
            "six"
          ],
          [
            "nine"
          ]
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Index",
                  "value": 1
                }
              ]
            }
          ]
        },
        "result": [
          [
            "three",
            "four"
          ],
          [
            "seven",
            "eight"
          ],
          [
            "ten"
          ]
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "IndexExpression",
                  "children": [
                    {
                      "type": "Identity"
                    },
                    {
                      "type": "Index",
                      "value": 0
                    }
                  ]
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": [
          "one",
          "five",
          "nine"
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "IndexExpression",
                  "children": [
                    {
                      "type": "Identity"
                    },
                    {
                      "type": "Index",
                      "value": 1
                    }
                  ]
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": [
          "three",
          "seven",
          "ten"
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "IndexExpression",
                  "children": [
                    {
                      "type": "Identity"
                    },
                    {
                      "type": "Index",
                      "value": 0
                    }
                  ]
                },
                {
                  "type": "Index",
                  "value": 1
                }
              ]
            }
          ]
        },
        "result": [
          "two",
          "six"
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "IndexExpression",
                  "children": [
                    {
                      "type": "Identity"
                    },
                    {
                      "type": "Index",
                      "value": 1
                    }
                  ]
                },
                {
                  "type": "Index",
                  "value": 1
                }
              ]
            }
          ]
        },
        "result": [
          "four",
          "eight"
        ]
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Index",
                  "value": 2
                }
              ]
            }
          ]
        },
        "result": []
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "foo"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "IndexExpression",
                  "children": [
                    {
                      "type": "Identity"
                    },
                    {
                      "type": "Index",
                      "value": 2
                    }
                  ]
                },
                {
                  "type": "Index",
                  "value": 2
                }
              ]
            }
          ]
        },
        "result": []
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "bar"
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "bar"
            },
            {
              "type": "Projection",
              "children": [
                {
                  "type": "Field",
                  "name": "baz"
                },
                {
                  "type": "Identity"
                }
              ]
            }
          ]
        },
        "result": null
      }
    ]
  },
  {
    "given": {
      "string": "string",
      "hash": {
        "foo": "bar",
        "bar": "baz"
      },
      "number": 23,
      "nullvalue": null
    },
    "cases": [
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "string"
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "hash"
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "number"
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "nullvalue"
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "string"
            },
            {
              "type": "Field",
              "name": "foo"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "hash"
            },
            {
              "type": "Field",
              "name": "foo"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "number"
            },
            {
              "type": "Field",
              "name": "foo"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "nullvalue"
            },
            {
              "type": "Field",
              "name": "foo"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "Projection",
          "children": [
            {
              "type": "Field",
              "name": "nullvalue"
            },
            {
              "type": "Projection",
              "children": [
                {
                  "type": "Field",
                  "name": "foo"
                },
                {
                  "type": "Field",
                  "name": "bar"
                }
              ]
            }
          ]
        },
        "result": null
      }
    ]
  },
  {
    "given": {
      "string": "string",
      "hash": {
        "foo": "val",
        "bar": "val"
      },
      "number": 23,
      "array": [
        1,
        2,
        3
      ],
      "nullvalue": null
    },
    "cases": [
      {
        "expression": {
          "type": "ValueProjection",
          "children": [
            {
              "type": "Field",
              "name": "string"
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "ValueProjection",
          "children": [
            {
              "type": "Field",
              "name": "hash"
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": [
          "val",
          "val"
        ]
      },
      {
        "expression": {
          "type": "ValueProjection",
          "children": [
            {
              "type": "Field",
              "name": "number"
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "ValueProjection",
          "children": [
            {
              "type": "Field",
              "name": "array"
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": null
      },
      {
        "expression": {
          "type": "ValueProjection",
          "children": [
            {
              "type": "Field",
              "name": "nullvalue"
            },
            {
              "type": "Identity"
            }
          ]
        },
        "result": null
      }
    ]
  },
  {
    "given": {
      "a": [
        0,
        1,
        2
      ],
      "b": [
        0,
        1,
        2
      ]
    },
    "cases": [
      {
        "expression": {
          "type": "ValueProjection",
          "children": [
            {
              "type": "Identity"
            },
            {
              "type": "IndexExpression",
              "children": [
                {
                  "type": "Identity"
                },
                {
                  "type": "Index",
                  "value": 0
                }
              ]
            }
          ]
        },
        "result": [
          0,
          0
        ]
      }
    ]
  }
]